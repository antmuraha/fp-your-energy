var R=t=>{throw TypeError(t)};var _=(t,e,s)=>e.has(t)||R("Cannot "+s);var u=(t,e,s)=>(_(t,e,"read from private field"),s?s.call(t):e.get(t)),P=(t,e,s)=>e.has(t)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),$=(t,e,s,n)=>(_(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s);import{i as q}from"./assets/vendor-DVYrn7a6.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const ee=t=>{if(!t||typeof t!="object")return"";const e=Object.fromEntries(Object.entries(t).filter(([n,r])=>r!==void 0));return Object.keys(e).length===0?"":"?"+new URLSearchParams(e).toString()},te=(t,e)=>(s,{method:n="GET",query:r,body:o})=>new Promise(async(i,c)=>{const l=ee(r),a=await fetch(`${t}${s}${l}`,{method:n,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}});if(a.status>=500){c({status:a.status,data:null,error:a.statusText||"Unknown error",isError:!0});return}let g=null;try{g=await a.json()}catch{c({status:500,data:null,error:"Parse error",isError:!0})}if(a.status>=400){c({status:a.status,data:g,error:a.statusText||"Unknown error",isError:!0});return}i({status:a.status,data:g,error:null,isError:!1})}),S=te("https://your-energy.b.goit.study/api"),se=async(t,e)=>await S(t,{...e,method:"GET",body:void 0}),re=async(t,e)=>await S(t,{...e,method:"POST"}),oe=async(t,e)=>await S(t,{...e,method:"PUT"}),ne=async(t,e)=>await S(t,{...e,method:"PATCH"}),ie=async(t,e)=>await S(t,{...e,method:"DELETE"}),p={get:se,post:re,put:oe,patch:ne,del:ie};function V(t,e){document.dispatchEvent(new CustomEvent("stateChange",{detail:{branch:t,data:e}}))}const j="favorites";function ae(){const t=localStorage.getItem(j);if(t)try{return JSON.parse(t)}catch(e){return console.error("Error parsing favorites from local storage:",e),[]}return[]}function ce(t){if(!Array.isArray(t)){console.error("Invalid data type for favorites. Expected an array.");return}const e=Array.from(new Set(t.map(s=>s._id))).map(s=>t.find(n=>n._id===s));try{localStorage.setItem(j,JSON.stringify(e))}catch(s){console.error("Error saving favorites to local storage:",s)}}const v={get:ae,set:ce},le=async(t,e=1,s=12)=>p.get("/filters",{query:{filter:t,page:e,limit:s}}),de=async()=>p.get("/quote"),ue=async(t={})=>p.get("/exercises",{query:{bodypart:t.bodypart,muscles:t.muscles,equipment:t.equipment,keyword:t.keyword,page:t.page||1,limit:t.limit||10}}),ge=async(t,e)=>p.patch(`/exercises/${t}/rating`,{body:{rate:e.rate,email:e.email,review:e.review}}),H=async t=>p.get(`/exercises/${t}`),fe=async t=>p.post("/subscription",{body:{email:t}}),me=async t=>{const e=await H(t);v.set([...v.get(),e.data]);const s=v.get();V("favorites",s)},he=async t=>{const e=v.get().filter(s=>s._id!==t);v.set(e),V("favorites",e)},E={getFilters:le,getQuoteOfDay:de,getExercises:ue,addExerciseRating:ge,getExerciseById:H,subscribe:fe,addToFavorites:me,removeFromFavorites:he},k={BODY_PARTS:"Body parts",Muscles:"Muscles",Equipment:"Equipment"},ye={[k.BODY_PARTS]:"bodypart",[k.Muscles]:"muscles",[k.Equipment]:"equipment"},pe={MAP_GROUPS_TO_QUERY_PARAMS:ye};var m,h;class ve{constructor(e={}){P(this,m,{});P(this,h,{});$(this,m,{...e}),this.startListening()}startListening(){document.addEventListener("stateChange",e=>{const{branch:s,data:n}=e.detail;console.log("Received new state:",s,n),this.setState(s,n)})}getState(e){return u(this,m)[e]}setState(e,s){u(this,m)[e]!==s&&(u(this,m)[e]=s,this.notify(e))}subscribe(e,s){u(this,h)[e]||(u(this,h)[e]=[]),u(this,h)[e].push(s),s(u(this,m)[e],u(this,m))}notify(e){if(u(this,h)[e])for(const s of u(this,h)[e])s(u(this,m)[e],u(this,m))}}m=new WeakMap,h=new WeakMap;class be{constructor(){this.subscribers=new Map,window.addEventListener("hashchange",this.handleHashChange.bind(this))}handleHashChange(){const e=window.location.hash;this.subscribers.forEach((s,n)=>{s(e)})}subscribe(e,s){return this.subscribers.has(e)||this.subscribers.set(e,s),()=>{this.subscribers.delete(e)}}isActive(e){return window.location.hash===e}}const O={timeout:3e3,close:!1,closeOnClick:!0,icon:null,position:"topRight",transitionIn:"fadeInDown",transitionOut:"fadeOutUp"};class y{static success(e){q.success({title:"OK",titleColor:"green",message:e,messageColor:"green",progressBarColor:"green",...O})}static error(e){q.error({title:"Error",titleColor:"red",message:e,messageColor:"red",progressBarColor:"red",...O})}static warning(e){q.warning({title:"Caution",message:e,titleColor:"red",messageColor:"red",progressBarColor:"red",...O})}}function K(t,e=!1){const r=document.querySelector("#templates").content.querySelector(".favorites-workout-card").cloneNode(!0);return r.dataset.id=t._id,e?r.querySelector(".rating").classList.add("hidden"):(r.querySelector(".delete").classList.add("hidden"),r.querySelector(".rating").textContent=t.rating),r.querySelector(".title").textContent=t.name,r.querySelector(".burned-calories").textContent=`${t.burnedCalories} / ${t.time} min`,r.querySelector(".group").textContent=t._group,r.querySelector(".group-target").textContent=t.bodyPart,r.querySelector(".filter").textContent=t.target,r}function Y(t,e){const s=document.querySelector(".exercises-workout-list");if(!e){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.innerHTML="",t.forEach(n=>{const r=K(n);s.appendChild(r)})}function Se(t){const e=document.querySelector(".favorites-content-list"),s=e==null?void 0:e.querySelector(".favorites-list"),n=e==null?void 0:e.querySelector(".favorites-empty-message");if(s.innerHTML="",t.length===0){n.classList.remove("hidden"),s.classList.add("hidden");return}n.classList.add("hidden"),s.classList.remove("hidden"),t.forEach(r=>{const o=K(r,!0);s.appendChild(o)})}function Ee(t,{group:e,filter:s,image:n}){const o=document.querySelector("#templates").content.querySelector(".exercises-card-filter");let i=o==null?void 0:o.getAttribute("style");if(i=i.replace("{=$image}",`${n}`),t)t.setAttribute("style",i),t.querySelector("h3").textContent=s,t.querySelector("h3").setAttribute("data-filter",s),t.querySelector("div").textContent=e,t.querySelector("div").setAttribute("data-group",e);else{const c=o.cloneNode(!0);return c.setAttribute("style",i),c.querySelector("h3").textContent=s,c.querySelector("h3").setAttribute("data-filter",s),c.querySelector("div").textContent=e,c.querySelector("div").setAttribute("data-group",e),c}}function J(t,e){const s=document.querySelector(".exercises-filters-list");if(e){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),t.forEach((n,r)=>{const{filter:o,imgURL:i,name:c}=n;if(s.children[r])Ee(s.children[r],{filter:c,image:i,group:o});else{const l=document.createElement("div");l.setAttribute("src",i),l.setAttribute("group",o.group),l.setAttribute("filter",o.filter),l.setAttribute("image",o.image),s.appendChild(l)}})}function M(t){if(!t)return null;for(;t&&!t.dataset.id;)t=t.parentElement;return t?t.dataset.id:null}const Q=new be,d=new ve({loading:!1,selectedGroup:"Muscles",selectedFilter:null,filtersPage:1,filtersPerPage:12,filtersTotalPages:null,filters:[],exercises:[],exercisesPage:1,exercisesPerPage:10,exercisesTotalPages:null,showFavorites:Q.isActive("#favorites"),favorites:v.get()||[]});Q.subscribe("main",t=>{console.log("Main hash changed:",t);const e={"#favorites":()=>d.setState("showFavorites",!0),"":()=>d.setState("showFavorites",!1)};try{e[t]()}catch{console.error("Not implemented action for hash:",t)}});d.subscribe("showFavorites",(t,e)=>{console.log("Show favorites state changed:",t);const s=document.querySelector("#favorites-content");t?(s.classList.remove("hidden"),s.style.setProperty("--height",`${window.innerHeight}px`)):s.classList.add("hidden")});const L=document.querySelector(".tabs-controls");L.addEventListener("click",t=>{var e;if(t.target.dataset.group){(e=L==null?void 0:L.querySelector(".active"))==null||e.classList.remove("active"),t.target.classList.add("active");const s=t.target.dataset.group;console.log("Selected category:",s),d.setState("selectedGroup",s),d.setState("selectedFilter",null)}});function T(t,e,s){return`${t}-${e}-${s}`}d.subscribe("selectedGroup",async(t,e)=>{console.log("Selected category changed:",t);const s=T(e.filtersPerPage,e.filtersPage,t);if(e.filters.some(a=>a._key===s)){console.log("Filters already loaded for this group:",t,e.filters),d.setState("filters",[...e.filters]);return}const r=await E.getFilters(t);if(console.log("Filters data:",t,r,e),r.isError){console.error("Error fetching filters:",r.error);return}const{results:o,page:i,perPage:c,totalPages:l}=r.data;d.setState("filters",[...e.filters,...o.map(a=>({...a,_key:T(c,i,t)}))])});d.subscribe("filters",(t,e)=>{const{filtersPerPage:s,filtersPage:n,selectedGroup:r}=e,o=t.filter(i=>i._key===T(s,n,r));console.log("Filters list:",o),J(o)});d.subscribe("selectedFilter",(t,e)=>{t&&J(null,t)});const F=document.querySelector(".exercises-filters-list");F==null||F.addEventListener("click",t=>{if(t.target.classList.contains("exercises-card-filter")){const e=t.target.querySelector("[data-filter]").dataset.filter;console.log("Selected filter:",e),d.setState("selectedFilter",e)}});function B(t,e,s,n){return`${t}-${e}-${s}-${n}`}d.subscribe("selectedFilter",async(t,e)=>{if(!t){console.log("No filter selected, skipping exercises fetch");return}const s=B(e.exercisesPerPage,e.exercisesPage,e.selectedGroup,t);if(e.exercises.some(i=>i._key===s)){console.log("Exercises already loaded for this filter:",t,e.exercises),d.setState("exercises",[...e.exercises]);return}const o={[pe.MAP_GROUPS_TO_QUERY_PARAMS[e.selectedGroup]]:t,page:e.exercisesPage,limit:e.exercisesPerPage};E.getExercises(o).then(i=>{if(i.isError){console.error("Error fetching exercises:",i.error);return}const{results:c,page:l,perPage:a,totalPages:g}=i.data;console.log("Exercises data:",i.data),d.setState("exercises",[...e.exercises,...c.map(f=>({...f,_group:e.selectedGroup,_key:B(a,l,e.selectedGroup,t)}))]),d.setState("exercisesPage",l),d.setState("exercisesPerPage",a),d.setState("exercisesTotalPages",g)})});d.subscribe("exercises",(t,e)=>{const{exercisesPerPage:s,exercisesPage:n,selectedGroup:r,selectedFilter:o}=e,i=t.filter(c=>c._key===B(s,n,r,o));console.log("Exercises list:",{exercises:t,list:i}),Y(i,o)});d.subscribe("selectedFilter",(t,e)=>{t||Y(!1,t)});d.subscribe("favorites",(t,e)=>{console.log("Favorites list:",t),Se(t)});var G;(G=document.querySelector(".favorites-content-list"))==null||G.addEventListener("click",t=>{if(t.target.classList.contains("delete")){const e=M(t.target);E.removeFromFavorites(e).then(()=>{y.error("Exercise removed from favorites")}).catch(s=>{y.error("Failed to remove exercise from favorites")})}});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("burgerBtn"),e=document.getElementById("burgerMenu"),s=document.getElementById("close-mob-menu"),n=document.querySelector(".social-links"),r=()=>{window.innerWidth<=768?n.style.display="none":n.style.display=""};t.addEventListener("click",()=>{e.classList.add("open")}),s.addEventListener("click",()=>{e.classList.remove("open")}),window.addEventListener("click",o=>{!e.contains(o.target)&&!t.contains(o.target)&&e.classList.remove("open")}),r(),window.addEventListener("resize",r)});document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".link-home-btn"),e=document.querySelector(".link-favorites-btn");function s(n,r){n.classList.add("nav-btn-active"),n.classList.remove("nav-btn-inactive"),r.classList.add("nav-btn-inactive"),r.classList.remove("nav-btn-active")}t.addEventListener("click",n=>{s(t,e)}),e.addEventListener("click",n=>{s(e,t)})});const D=document.querySelector(".quote-description"),N=document.querySelector(".quote-author");async function xe(){const t=new Date().toISOString().split("T")[0],e=JSON.parse(localStorage.getItem("quoteOfTheDay"));if(e&&e.date===t)D.textContent=e.quote.quote,N.textContent=e.quote.author;else{const{data:s,isError:n,error:r}=await p.get("/quote");n||(D.textContent=s.quote,N.textContent=s.author,localStorage.setItem("quoteOfTheDay",JSON.stringify({date:t,quote:s})))}}xe();const w=document.getElementById("subscribeForm"),C=w.querySelector('input[name="email"]'),U=document.getElementById("subscribeBtn");C.addEventListener("input",Le);w.addEventListener("submit",we);function z(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}function Le(){const t=C.value,e=z(t);C.style.borderColor=e?"green":"red"}async function we(t){t.preventDefault();const s=new FormData(w).get("email");if(!z(s))return console.error("Invalid email address"),y.error("Invalid email address");U.disabled=!0,E.subscribe(s).then(r=>{w.reset(),C.style.borderColor="",y.success(`${r.data.message}`)}).catch(r=>{var o;return y.error(((o=r==null?void 0:r.data)==null?void 0:o.message)||"Subscription failed")}).finally(()=>{U.disabled=!1})}function Ce(t){alert("Click Rating on workout card with id: "+t);const e=document.getElementById("modal-rating");e.style.display="block";const s=document.getElementById("subscribe-details-form"),n=document.getElementById("modal-close"),r=document.getElementById("rating-value"),o=document.getElementById("rating-stars");let i=0;o==null||o.addEventListener("click",l=>{const a=o.getBoundingClientRect(),f=(l.clientX-a.left)/a.width;i=Math.round(f*5),r.textContent=i.toFixed(1),c(i)}),o&&r&&(o.addEventListener("mousemove",l=>{const a=o.getBoundingClientRect(),f=(l.clientX-a.left)/a.width,x=Math.round(f*5*10)/10;r.textContent=x.toFixed(1),c(x)}),o.addEventListener("mouseleave",()=>{r.textContent=i.toFixed(1),c(i)}),o.addEventListener("click",l=>{const a=o.getBoundingClientRect(),f=(l.clientX-a.left)/a.width;i=Math.round(f*5*10)/10,r.textContent=i.toFixed(1),c(i)}));function c(l){const a=o.textContent.split("").map((g,f)=>f<Math.round(l)?"★":"☆");o.textContent=a.join("")}n.addEventListener("click",()=>{e.style.display="none",i=0,r.textContent="0.0",c(0)}),s.addEventListener("submit",async l=>{l.preventDefault();const a="64f389465ae26083f39b17a2",g=s.elements.email,f=s.elements.comment,x=g.value.trim(),X=f.value.trim(),W=i;if(!g.checkValidity()){alert("Please enter a valid email address.");return}try{const b=await fetch(`https://your-energy.b.goit.study/api/exercises/${a}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:W,email:x,review:X})});if(b.status===409){alert("You have already submitted a review for this exercise.");return}else if(b.ok)alert("Your feedback has been submitted!");else{const Z=await b.json();alert(`Error ${b.status}: ${Z.message||"Unknown error"}`);return}alert("Your feedback has been submitted!"),s.reset(),e.style.display="none"}catch{alert("Something went wrong. Please try again later.")}})}const I=document.querySelector(".exercises-workout-list");I==null||I.addEventListener("click",t=>{if(t.target.classList.contains("start")){const e=M(t.target);E.addToFavorites(e).then(()=>{y.success("Exercise added to favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),y.error("Failed to add exercise to favorites")})}});const A=document.querySelector(".exercises-workout-list");A==null||A.addEventListener("click",t=>{if(t.target.classList.contains("rating")){const e=M(t.target);Ce(e)}});
//# sourceMappingURL=index.js.map
