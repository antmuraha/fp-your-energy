var G=e=>{throw TypeError(e)};var N=(e,t,s)=>t.has(e)||G("Cannot "+s);var f=(e,t,s)=>(N(e,t,"read from private field"),s?s.call(e):t.get(e)),k=(e,t,s)=>t.has(e)?G("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),U=(e,t,s,n)=>(N(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s);import{i as _}from"./assets/vendor-DVYrn7a6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const ce=e=>{if(!e||typeof e!="object")return"";const t=Object.fromEntries(Object.entries(e).filter(([n,r])=>r!==void 0));return Object.keys(t).length===0?"":"?"+new URLSearchParams(t).toString()},le=(e,t)=>(s,{method:n="GET",query:r,body:o})=>new Promise(async(i,c)=>{const d=ce(r),l=await fetch(`${e}${s}${d}`,{method:n,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}});if(l.status>=500){c({status:l.status,data:null,error:l.statusText||"Unknown error",isError:!0});return}let u=null;try{u=await l.json()}catch{c({status:500,data:null,error:"Parse error",isError:!0})}if(l.status>=400){c({status:l.status,data:u,error:l.statusText||"Unknown error",isError:!0});return}i({status:l.status,data:u,error:null,isError:!1})}),P=le("https://your-energy.b.goit.study/api"),de=async(e,t)=>await P(e,{...t,method:"GET",body:void 0}),ue=async(e,t)=>await P(e,{...t,method:"POST"}),ge=async(e,t)=>await P(e,{...t,method:"PUT"}),fe=async(e,t)=>await P(e,{...t,method:"PATCH"}),me=async(e,t)=>await P(e,{...t,method:"DELETE"}),b={get:de,post:ue,put:ge,patch:fe,del:me};function z(e,t){document.dispatchEvent(new CustomEvent("stateChange",{detail:{branch:e,data:t}}))}const J="favorites";function ye(){const e=localStorage.getItem(J);if(e)try{return JSON.parse(e)}catch(t){return console.error("Error parsing favorites from local storage:",t),[]}return[]}function he(e){if(!Array.isArray(e)){console.error("Invalid data type for favorites. Expected an array.");return}const t=Array.from(new Set(e.map(s=>s._id))).map(s=>e.find(n=>n._id===s));try{localStorage.setItem(J,JSON.stringify(t))}catch(s){console.error("Error saving favorites to local storage:",s)}}const v={get:ye,set:he},pe=async(e,t=1,s=12)=>b.get("/filters",{query:{filter:e,page:t,limit:s}}),ve=async()=>b.get("/quote"),be=async(e={})=>b.get("/exercises",{query:{bodypart:e.bodypart,muscles:e.muscles,equipment:e.equipment,keyword:e.keyword,page:e.page||1,limit:e.limit||10}}),Se=async(e,t)=>b.patch(`/exercises/${e}/rating`,{body:{rate:t.rate,email:t.email,review:t.review}}),Q=async e=>b.get(`/exercises/${e}`),xe=async e=>b.post("/subscription",{body:{email:e}}),Ee=async e=>{const t=await Q(e);v.set([...v.get(),t.data]);const s=v.get();z("favorites",s)},Le=async e=>{const t=v.get().filter(s=>s._id!==e);v.set(t),z("favorites",t)},Pe=async e=>v.get().some(t=>t._id===e),h={getFilters:pe,getQuoteOfDay:ve,getExercises:be,addExerciseRating:Se,getExerciseById:Q,subscribe:xe,addToFavorites:Ee,removeFromFavorites:Le,isFavorite:Pe},T={BODY_PARTS:"Body parts",Muscles:"Muscles",Equipment:"Equipment"},we={[T.BODY_PARTS]:"bodypart",[T.Muscles]:"muscles",[T.Equipment]:"equipment"},qe={MAP_GROUPS_TO_QUERY_PARAMS:we};var y,p;class Ce{constructor(t={}){k(this,y,{});k(this,p,{});U(this,y,{...t}),this.startListening()}startListening(){document.addEventListener("stateChange",t=>{const{branch:s,data:n}=t.detail;console.log("Received new state:",s,n),this.setState(s,n)})}getState(t){return f(this,y)[t]}setState(t,s){f(this,y)[t]!==s&&(f(this,y)[t]=s,this.notify(t))}subscribe(t,s){f(this,p)[t]||(f(this,p)[t]=[]),f(this,p)[t].push(s),s(f(this,y)[t],f(this,y))}notify(t){if(f(this,p)[t])for(const s of f(this,p)[t])s(f(this,y)[t],f(this,y))}}y=new WeakMap,p=new WeakMap;class Fe{constructor(){this.subscribers=new Map,window.addEventListener("hashchange",this.handleHashChange.bind(this))}handleHashChange(){const t=window.location.hash;this.subscribers.forEach((s,n)=>{s(t)})}subscribe(t,s){return this.subscribers.has(t)||this.subscribers.set(t,s),()=>{this.subscribers.delete(t)}}isActive(t){return window.location.hash===t}}const B={timeout:3e3,close:!1,closeOnClick:!0,icon:null,position:"topRight",transitionIn:"fadeInDown",transitionOut:"fadeOutUp"};class g{static success(t){_.success({title:"OK",titleColor:"green",message:t,messageColor:"green",progressBarColor:"green",...B})}static error(t){_.error({title:"Error",titleColor:"red",message:t,messageColor:"red",progressBarColor:"red",...B})}static warning(t){_.warning({title:"Caution",message:t,titleColor:"red",messageColor:"red",progressBarColor:"red",...B})}}function X(e,t=!1){const r=document.querySelector("#templates").content.querySelector(".favorites-workout-card").cloneNode(!0);return r.dataset.id=e._id,t?(r.querySelector(".start").classList.add("hidden"),r.querySelector(".rating").classList.add("hidden")):(r.querySelector(".delete").classList.add("hidden"),r.querySelector(".rating").textContent=e.rating),r.querySelector(".title").textContent=e.name,r.querySelector(".burned-calories").textContent=`${e.burnedCalories} / ${e.time} min`,r.querySelector(".group").textContent=e._group,r.querySelector(".group-target").textContent=e.bodyPart,r.querySelector(".filter").textContent=e.target,r}function W(e,t){const s=document.querySelector(".exercises-workout-list");if(!t){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.innerHTML="",e.forEach(n=>{const r=X(n);s.appendChild(r)})}function ke(e){const t=document.querySelector(".favorites-content-list"),s=t==null?void 0:t.querySelector(".favorites-list"),n=t==null?void 0:t.querySelector(".favorites-empty-message");if(s.innerHTML="",e.length===0){n.classList.remove("hidden"),s.classList.add("hidden");return}n.classList.add("hidden"),s.classList.remove("hidden"),e.forEach(r=>{const o=X(r,!0);s.appendChild(o)})}function _e(e,{group:t,filter:s,image:n}){const o=document.querySelector("#templates").content.querySelector(".exercises-card-filter");let i=o==null?void 0:o.getAttribute("style");if(i=i.replace("{=$image}",`${n}`),e)e.setAttribute("style",i),e.querySelector("h3").textContent=s,e.querySelector("h3").setAttribute("data-filter",s),e.querySelector("div").textContent=t,e.querySelector("div").setAttribute("data-group",t);else{const c=o.cloneNode(!0);return c.setAttribute("style",i),c.querySelector("h3").textContent=s,c.querySelector("h3").setAttribute("data-filter",s),c.querySelector("div").textContent=t,c.querySelector("div").setAttribute("data-group",t),c}}const V=12;function Z(e,t){var n;const s=document.querySelector(".exercises-filters-list");if(t){s==null||s.classList.add("hidden");return}if(s==null||s.classList.remove("hidden"),e.forEach((r,o)=>{const{filter:i,imgURL:c,name:d}=r;s.children[o]&&(s.children[o].classList.remove("hidden"),_e(s.children[o],{filter:d,image:c,group:i}))}),e.length<V){const r=V-e.length;for(let o=0;o<r;o++)(n=s==null?void 0:s.children[o+e.length])==null||n.classList.add("hidden")}}function H(e,t){const s=document.getElementById("exercises-list-pagination-buttons");if(!t||t<=1||t=="1"){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.querySelector(".arrow-buttons-left"),s.querySelector(".arrow-buttons-right");const n=s.querySelector(".page-buttons");n.innerHTML="";for(let r=1;r<=t;r++){const o=document.createElement("button");o.dataset.page=r,o.className="page-button",o.textContent=r,r==e&&o.classList.add("active"),n.appendChild(o)}}function $(e){if(!e)return null;for(;e&&!e.dataset.id;)e=e.parentElement;return e?e.dataset.id:null}const ee=new Fe,a=new Ce({loading:!1,selectedGroup:"Muscles",selectedFilter:null,filtersPage:1,filtersPerPage:12,filtersTotalPages:null,filters:[],exercises:[],exercisesPage:1,exercisesPerPage:10,exercisesTotalPages:null,showFavorites:ee.isActive("#favorites"),favorites:v.get()||[]});ee.subscribe("main",e=>{console.log("Main hash changed:",e);const t={"#favorites":()=>a.setState("showFavorites",!0),"":()=>a.setState("showFavorites",!1)};try{t[e]()}catch{console.error("Not implemented action for hash:",e)}});a.subscribe("showFavorites",(e,t)=>{console.log("Show favorites state changed:",e);const s=document.querySelector("#favorites-content");e?(s.classList.remove("hidden"),s.style.setProperty("--height",`${window.innerHeight}px`)):s.classList.add("hidden")});const q=document.querySelector(".tabs-controls");q.addEventListener("click",e=>{var t;if(e.target.dataset.group){(t=q==null?void 0:q.querySelector(".active"))==null||t.classList.remove("active"),e.target.classList.add("active");const s=e.target.dataset.group;console.log("Selected category:",s),a.setState("selectedGroup",s),a.setState("selectedFilter",null)}});function O(e,t,s){return`${e}-${t}-${s}`}let E=!1;async function te(e){if(E){console.log("Filters are already being updated, skipping this call");return}E=!0;const{selectedGroup:t}=e;console.log("Selected category changed:",t);const s=O(e.filtersPerPage,e.filtersPage,t),n=e.filters.find(l=>l._key===s);if(n){console.log("Filters already loaded for this group:",t,e.filters),a.setState("filters",[...e.filters]),a.setState("filtersTotalPages",n._total),E=!1;return}const r=await h.getFilters(t,e.filtersPage);if(console.log("Filters data:",t,r,e),r.isError){console.error("Error fetching filters:",r.error),E=!1;return}const{results:o,page:i,perPage:c,totalPages:d}=r.data;a.setState("filters",[...e.filters,...o.map(l=>({...l,_key:O(c,i,t),_total:d}))]),a.setState("filtersPerPage",c),a.setState("filtersTotalPages",d),E=!1}a.subscribe("selectedGroup",(e,t)=>te(t));a.subscribe("filtersPage",(e,t)=>te(t));a.subscribe("filters",(e,t)=>{const{filtersPerPage:s,filtersPage:n,selectedGroup:r}=t,o=e.filter(i=>i._key===O(s,n,r));console.log("Filters list:",o),Z(o)});a.subscribe("selectedFilter",(e,t)=>{e&&Z(null,e)});const I=document.querySelector(".exercises-filters-list");I==null||I.addEventListener("click",e=>{if(e.target.classList.contains("exercises-card-filter")){const t=e.target.querySelector("[data-filter]").dataset.filter;console.log("Selected filter:",t),a.setState("selectedFilter",t)}});function R(e,t,s,n){return`${e}-${t}-${s}-${n}`}let L=!1;async function se(e){if(L){console.log("Exercises are already being updated, skipping this call");return}L=!0;const{selectedFilter:t}=e;if(!t){console.log("No filter selected, skipping exercises fetch"),L=!1;return}const s=R(e.exercisesPerPage,e.exercisesPage,e.selectedGroup,t),n=e.exercises.find(i=>i._key===s);if(n){console.log("Exercises already loaded for this filter:",t,e.exercises),a.setState("exercises",[...e.exercises]),a.setState("exercisesTotalPages",n._total),L=!1;return}const o={[qe.MAP_GROUPS_TO_QUERY_PARAMS[e.selectedGroup]]:t,page:e.exercisesPage,limit:e.exercisesPerPage};h.getExercises(o).then(i=>{if(i.isError){console.error("Error fetching exercises:",i.error);return}const{results:c,page:d,perPage:l,totalPages:u}=i.data;console.log("Exercises data:",i.data),a.setState("exercises",[...e.exercises,...c.map(m=>({...m,_group:e.selectedGroup,_key:R(l,d,e.selectedGroup,t),_total:u}))]),a.setState("exercisesPerPage",l),a.setState("exercisesTotalPages",u),L=!1})}a.subscribe("selectedFilter",(e,t)=>se(t));a.subscribe("exercisesPage",(e,t)=>se(t));a.subscribe("exercises",(e,t)=>{const{exercisesPerPage:s,exercisesPage:n,selectedGroup:r,selectedFilter:o}=t,i=e.filter(c=>c._key===R(s,n,r,o));console.log("Exercises list:",{exercises:e,list:i}),W(i,o)});a.subscribe("selectedFilter",(e,t)=>{e||W(!1,e)});a.subscribe("favorites",(e,t)=>{console.log("Favorites list:",e),ke(e)});var K;(K=document.querySelector(".favorites-content-list"))==null||K.addEventListener("click",e=>{if(e.target.classList.contains("delete")){const t=$(e.target);h.removeFromFavorites(t).then(()=>{g.success("Exercise removed from favorites")}).catch(s=>{g.error("Failed to remove exercise from favorites")})}});function S(e){const{selectedFilter:t}=e;t?H(e.exercisesPage,e.exercisesTotalPages):H(e.filtersPage,e.filtersTotalPages)}a.subscribe("filtersTotalPages",(e,t)=>S(t));a.subscribe("filtersPage",(e,t)=>S(t));a.subscribe("exercisesTotalPages",(e,t)=>S(t));a.subscribe("exercisesPage",(e,t)=>S(t));a.subscribe("selectedGroup",(e,t)=>S(t));a.subscribe("selectedFilter",(e,t)=>S(t));var Y;(Y=document.querySelector(".page-buttons"))==null||Y.addEventListener("click",e=>{const t=e.target.dataset.page;t&&(a.getState("selectedFilter")?a.setState("exercisesPage",Number(t)):a.setState("filtersPage",Number(t)))});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("burgerBtn"),t=document.getElementById("burgerMenu"),s=document.getElementById("close-mob-menu"),n=document.querySelector(".social-links"),r=()=>{window.innerWidth<=768?n.style.display="none":n.style.display=""};e.addEventListener("click",()=>{t.classList.add("open")}),s.addEventListener("click",()=>{t.classList.remove("open")}),window.addEventListener("click",o=>{!t.contains(o.target)&&!e.contains(o.target)&&t.classList.remove("open")}),r(),window.addEventListener("resize",r)});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".link-home-btn"),t=document.querySelector(".link-favorites-btn");function s(n,r){n.classList.add("nav-btn-active"),n.classList.remove("nav-btn-inactive"),r.classList.add("nav-btn-inactive"),r.classList.remove("nav-btn-active")}e.addEventListener("click",n=>{s(e,t)}),t.addEventListener("click",n=>{s(t,e)})});const C=document.getElementById("subscribeForm"),F=C.querySelector('input[name="email"]'),j=document.getElementById("subscribeBtn");F.addEventListener("input",Te);C.addEventListener("submit",Be);function re(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Te(){const e=F.value,t=re(e);F.style.borderColor=t?"green":"red"}async function Be(e){e.preventDefault();const s=new FormData(C).get("email");if(!re(s))return console.error("Invalid email address"),g.error("Invalid email address");j.disabled=!0,h.subscribe(s).then(r=>{C.reset(),F.style.borderColor="",g.success(`${r.data.message}`)}).catch(r=>{var o;return g.error(((o=r==null?void 0:r.data)==null?void 0:o.message)||"Subscription failed")}).finally(()=>{j.disabled=!1})}function oe(e){const t=document.getElementById("modal-rating");t.style.display="flex";const s=document.getElementById("subscribe-details-form"),n=document.getElementById("modal-close"),r=document.getElementById("rating-value"),o=document.getElementById("rating-stars");let i=0;o==null||o.addEventListener("click",d=>{const l=o.getBoundingClientRect(),m=(d.clientX-l.left)/l.width;i=Math.round(m*5),r.textContent=i.toFixed(1),c(i)}),o&&r&&(o.addEventListener("mousemove",d=>{const l=o.getBoundingClientRect(),m=(d.clientX-l.left)/l.width,w=Math.round(m*5*10)/10;r.textContent=w.toFixed(1),c(w)}),o.addEventListener("mouseleave",()=>{r.textContent=i.toFixed(1),c(i)}),o.addEventListener("click",d=>{const l=o.getBoundingClientRect(),m=(d.clientX-l.left)/l.width;i=Math.round(m*5*10)/10,r.textContent=i.toFixed(1),c(i)}));function c(d){o.querySelectorAll(".star-icon").forEach((u,m)=>{m<Math.round(d)?u.classList.add("active"):u.classList.remove("active")})}n.addEventListener("click",()=>{t.style.display="none",i=0,r.textContent="0.0",c(0)}),s.addEventListener("submit",async d=>{d.preventDefault();const l="64f389465ae26083f39b17a2",u=s.elements.email,m=s.elements.comment,w=u.value.trim(),ne=m.value.trim(),ie=i;if(!u.checkValidity()){g.error("Please enter a valid email address.");return}try{const x=await fetch(`https://your-energy.b.goit.study/api/exercises/${l}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:ie,email:w,review:ne})});if(x.status===409){g.warning("You have already submitted a review for this exercise.");return}else if(x.ok)g.success("Your feedback has been submitted successfully!"),s.reset(),t.style.display="none",i=0,r.textContent="0.0",c(0);else{const ae=await x.json();g.error(`Error ${x.status}: ${ae.message||"Unknown error"}`);return}}catch{g.error("Something went wrong. Please try again later.")}})}async function Ie(e){await h.isFavorite(e)?h.removeFromFavorites(e).then(()=>{g.success("Exercise removed from favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),g.error("Failed to remove exercise from favorites")}):h.addToFavorites(e).then(()=>{g.success("Exercise added to favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),g.error("Failed to add exercise to favorites")})}async function Me(e){var o,i,c;const t=(o=await h.getExerciseById(e))==null?void 0:o.data,s=await h.isFavorite(e);document.querySelector(".modal-title").textContent=t.name,s?(i=document.querySelector(".icon-favorite"))==null||i.classList.add("active"):(c=document.querySelector(".icon-favorite"))==null||c.classList.remove("active"),document.querySelector(".modal-rate-value").textContent=t.rating;const n=document.querySelectorAll(".exercise-info-text"),r=[t.target,t.bodyPart,t.equipment,t.popularity,t.burnedCalories];n.forEach((d,l)=>d.textContent=r[l]),document.querySelector(".modal-img").setAttribute("src",t.gifUrl),document.querySelector(".modal-description").textContent=t.description,document.querySelector(".btn-favorite").onclick=()=>{var d;Ie(e),(d=document.querySelector(".icon-favorite"))==null||d.classList.toggle("active")},document.querySelector(".btn-rating").onclick=()=>{D(),oe()},document.querySelector(".backdrop").classList.add("is-open"),document.body.classList.add("modal-open")}function D(){document.querySelector(".backdrop").classList.remove("is-open"),document.body.classList.remove("modal-open")}document.querySelector(".modal-close-btn").addEventListener("click",D);document.querySelector(".backdrop").addEventListener("click",e=>{e.target===e.currentTarget&&D()});const M=document.querySelector(".exercises-workout-list");M==null||M.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=$(e.target);Me(t)}});const A=document.querySelector(".exercises-workout-list");A==null||A.addEventListener("click",e=>{e.target.classList.contains("rating")&&($(e.target),oe())});
//# sourceMappingURL=index.js.map
