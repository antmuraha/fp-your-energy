var _=e=>{throw TypeError(e)};var $=(e,t,s)=>t.has(e)||_("Cannot "+s);var f=(e,t,s)=>($(e,t,"read from private field"),s?s.call(e):t.get(e)),P=(e,t,s)=>t.has(e)?_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),D=(e,t,s,n)=>($(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s);import{i as C}from"./assets/vendor-DVYrn7a6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const ee=e=>{if(!e||typeof e!="object")return"";const t=Object.fromEntries(Object.entries(e).filter(([n,r])=>r!==void 0));return Object.keys(t).length===0?"":"?"+new URLSearchParams(t).toString()},te=(e,t)=>(s,{method:n="GET",query:r,body:o})=>new Promise(async(i,c)=>{const l=ee(r),a=await fetch(`${e}${s}${l}`,{method:n,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}});if(a.status>=500){c({status:a.status,data:null,error:a.statusText||"Unknown error",isError:!0});return}let u=null;try{u=await a.json()}catch{c({status:500,data:null,error:"Parse error",isError:!0})}if(a.status>=400){c({status:a.status,data:u,error:a.statusText||"Unknown error",isError:!0});return}i({status:a.status,data:u,error:null,isError:!1})}),E=te("https://your-energy.b.goit.study/api"),se=async(e,t)=>await E(e,{...t,method:"GET",body:void 0}),re=async(e,t)=>await E(e,{...t,method:"POST"}),oe=async(e,t)=>await E(e,{...t,method:"PUT"}),ne=async(e,t)=>await E(e,{...t,method:"PATCH"}),ie=async(e,t)=>await E(e,{...t,method:"DELETE"}),b={get:se,post:re,put:oe,patch:ne,del:ie};function G(e,t){document.dispatchEvent(new CustomEvent("stateChange",{detail:{branch:e,data:t}}))}const V="favorites";function ae(){const e=localStorage.getItem(V);if(e)try{return JSON.parse(e)}catch(t){return console.error("Error parsing favorites from local storage:",t),[]}return[]}function ce(e){if(!Array.isArray(e)){console.error("Invalid data type for favorites. Expected an array.");return}const t=Array.from(new Set(e.map(s=>s._id))).map(s=>e.find(n=>n._id===s));try{localStorage.setItem(V,JSON.stringify(t))}catch(s){console.error("Error saving favorites to local storage:",s)}}const p={get:ae,set:ce},le=async(e,t=1,s=12)=>b.get("/filters",{query:{filter:e,page:t,limit:s}}),de=async()=>b.get("/quote"),ue=async(e={})=>b.get("/exercises",{query:{bodypart:e.bodypart,muscles:e.muscles,equipment:e.equipment,keyword:e.keyword,page:e.page||1,limit:e.limit||10}}),ge=async(e,t)=>b.patch(`/exercises/${e}/rating`,{body:{rate:t.rate,email:t.email,review:t.review}}),H=async e=>b.get(`/exercises/${e}`),fe=async e=>b.post("/subscription",{body:{email:e}}),me=async e=>{const t=await H(e);p.set([...p.get(),t.data]);const s=p.get();G("favorites",s)},ye=async e=>{const t=p.get().filter(s=>s._id!==e);p.set(t),G("favorites",t)},he=async e=>p.get().some(t=>t._id===e),h={getFilters:le,getQuoteOfDay:de,getExercises:ue,addExerciseRating:ge,getExerciseById:H,subscribe:fe,addToFavorites:me,removeFromFavorites:ye,isFavorite:he},F={BODY_PARTS:"Body parts",Muscles:"Muscles",Equipment:"Equipment"},ve={[F.BODY_PARTS]:"bodypart",[F.Muscles]:"muscles",[F.Equipment]:"equipment"},pe={MAP_GROUPS_TO_QUERY_PARAMS:ve};var y,v;class be{constructor(t={}){P(this,y,{});P(this,v,{});D(this,y,{...t}),this.startListening()}startListening(){document.addEventListener("stateChange",t=>{const{branch:s,data:n}=t.detail;console.log("Received new state:",s,n),this.setState(s,n)})}getState(t){return f(this,y)[t]}setState(t,s){f(this,y)[t]!==s&&(f(this,y)[t]=s,this.notify(t))}subscribe(t,s){f(this,v)[t]||(f(this,v)[t]=[]),f(this,v)[t].push(s),s(f(this,y)[t],f(this,y))}notify(t){if(f(this,v)[t])for(const s of f(this,v)[t])s(f(this,y)[t],f(this,y))}}y=new WeakMap,v=new WeakMap;class Se{constructor(){this.subscribers=new Map,window.addEventListener("hashchange",this.handleHashChange.bind(this))}handleHashChange(){const t=window.location.hash;this.subscribers.forEach((s,n)=>{s(t)})}subscribe(t,s){return this.subscribers.has(t)||this.subscribers.set(t,s),()=>{this.subscribers.delete(t)}}isActive(t){return window.location.hash===t}}const k={timeout:3e3,close:!1,closeOnClick:!0,icon:null,position:"topRight",transitionIn:"fadeInDown",transitionOut:"fadeOutUp"};class g{static success(t){C.success({title:"OK",titleColor:"green",message:t,messageColor:"green",progressBarColor:"green",...k})}static error(t){C.error({title:"Error",titleColor:"red",message:t,messageColor:"red",progressBarColor:"red",...k})}static warning(t){C.warning({title:"Caution",message:t,titleColor:"red",messageColor:"red",progressBarColor:"red",...k})}}function j(e,t=!1){const r=document.querySelector("#templates").content.querySelector(".favorites-workout-card").cloneNode(!0);return r.dataset.id=e._id,t?(r.querySelector(".start").classList.add("hidden"),r.querySelector(".rating").classList.add("hidden")):(r.querySelector(".delete").classList.add("hidden"),r.querySelector(".rating").textContent=e.rating),r.querySelector(".title").textContent=e.name,r.querySelector(".burned-calories").textContent=`${e.burnedCalories} / ${e.time} min`,r.querySelector(".group").textContent=e._group,r.querySelector(".group-target").textContent=e.bodyPart,r.querySelector(".filter").textContent=e.target,r}function K(e,t){const s=document.querySelector(".exercises-workout-list");if(!t){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.innerHTML="",e.forEach(n=>{const r=j(n);s.appendChild(r)})}function Ee(e){const t=document.querySelector(".favorites-content-list"),s=t==null?void 0:t.querySelector(".favorites-list"),n=t==null?void 0:t.querySelector(".favorites-empty-message");if(s.innerHTML="",e.length===0){n.classList.remove("hidden"),s.classList.add("hidden");return}n.classList.add("hidden"),s.classList.remove("hidden"),e.forEach(r=>{const o=j(r,!0);s.appendChild(o)})}function xe(e,{group:t,filter:s,image:n}){const o=document.querySelector("#templates").content.querySelector(".exercises-card-filter");let i=o==null?void 0:o.getAttribute("style");if(i=i.replace("{=$image}",`${n}`),e)e.setAttribute("style",i),e.querySelector("h3").textContent=s,e.querySelector("h3").setAttribute("data-filter",s),e.querySelector("div").textContent=t,e.querySelector("div").setAttribute("data-group",t);else{const c=o.cloneNode(!0);return c.setAttribute("style",i),c.querySelector("h3").textContent=s,c.querySelector("h3").setAttribute("data-filter",s),c.querySelector("div").textContent=t,c.querySelector("div").setAttribute("data-group",t),c}}function Y(e,t){const s=document.querySelector(".exercises-filters-list");if(t){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),e.forEach((n,r)=>{const{filter:o,imgURL:i,name:c}=n;if(s.children[r])xe(s.children[r],{filter:c,image:i,group:o});else{const l=document.createElement("div");l.setAttribute("src",i),l.setAttribute("group",o.group),l.setAttribute("filter",o.filter),l.setAttribute("image",o.image),s.appendChild(l)}})}function T(e){if(!e)return null;for(;e&&!e.dataset.id;)e=e.parentElement;return e?e.dataset.id:null}const J=new Se,d=new be({loading:!1,selectedGroup:"Muscles",selectedFilter:null,filtersPage:1,filtersPerPage:12,filtersTotalPages:null,filters:[],exercises:[],exercisesPage:1,exercisesPerPage:10,exercisesTotalPages:null,showFavorites:J.isActive("#favorites"),favorites:p.get()||[]});J.subscribe("main",e=>{console.log("Main hash changed:",e);const t={"#favorites":()=>d.setState("showFavorites",!0),"":()=>d.setState("showFavorites",!1)};try{t[e]()}catch{console.error("Not implemented action for hash:",e)}});d.subscribe("showFavorites",(e,t)=>{console.log("Show favorites state changed:",e);const s=document.querySelector("#favorites-content");e?(s.classList.remove("hidden"),s.style.setProperty("--height",`${window.innerHeight}px`)):s.classList.add("hidden")});const L=document.querySelector(".tabs-controls");L.addEventListener("click",e=>{var t;if(e.target.dataset.group){(t=L==null?void 0:L.querySelector(".active"))==null||t.classList.remove("active"),e.target.classList.add("active");const s=e.target.dataset.group;console.log("Selected category:",s),d.setState("selectedGroup",s),d.setState("selectedFilter",null)}});function M(e,t,s){return`${e}-${t}-${s}`}d.subscribe("selectedGroup",async(e,t)=>{console.log("Selected category changed:",e);const s=M(t.filtersPerPage,t.filtersPage,e);if(t.filters.some(a=>a._key===s)){console.log("Filters already loaded for this group:",e,t.filters),d.setState("filters",[...t.filters]);return}const r=await h.getFilters(e);if(console.log("Filters data:",e,r,t),r.isError){console.error("Error fetching filters:",r.error);return}const{results:o,page:i,perPage:c,totalPages:l}=r.data;d.setState("filters",[...t.filters,...o.map(a=>({...a,_key:M(c,i,e)}))])});d.subscribe("filters",(e,t)=>{const{filtersPerPage:s,filtersPage:n,selectedGroup:r}=t,o=e.filter(i=>i._key===M(s,n,r));console.log("Filters list:",o),Y(o)});d.subscribe("selectedFilter",(e,t)=>{e&&Y(null,e)});const A=document.querySelector(".exercises-filters-list");A==null||A.addEventListener("click",e=>{if(e.target.classList.contains("exercises-card-filter")){const t=e.target.querySelector("[data-filter]").dataset.filter;console.log("Selected filter:",t),d.setState("selectedFilter",t)}});function O(e,t,s,n){return`${e}-${t}-${s}-${n}`}d.subscribe("selectedFilter",async(e,t)=>{if(!e){console.log("No filter selected, skipping exercises fetch");return}const s=O(t.exercisesPerPage,t.exercisesPage,t.selectedGroup,e);if(t.exercises.some(i=>i._key===s)){console.log("Exercises already loaded for this filter:",e,t.exercises),d.setState("exercises",[...t.exercises]);return}const o={[pe.MAP_GROUPS_TO_QUERY_PARAMS[t.selectedGroup]]:e,page:t.exercisesPage,limit:t.exercisesPerPage};h.getExercises(o).then(i=>{if(i.isError){console.error("Error fetching exercises:",i.error);return}const{results:c,page:l,perPage:a,totalPages:u}=i.data;console.log("Exercises data:",i.data),d.setState("exercises",[...t.exercises,...c.map(m=>({...m,_group:t.selectedGroup,_key:O(a,l,t.selectedGroup,e)}))]),d.setState("exercisesPage",l),d.setState("exercisesPerPage",a),d.setState("exercisesTotalPages",u)})});d.subscribe("exercises",(e,t)=>{const{exercisesPerPage:s,exercisesPage:n,selectedGroup:r,selectedFilter:o}=t,i=e.filter(c=>c._key===O(s,n,r,o));console.log("Exercises list:",{exercises:e,list:i}),K(i,o)});d.subscribe("selectedFilter",(e,t)=>{e||K(!1,e)});d.subscribe("favorites",(e,t)=>{console.log("Favorites list:",e),Ee(e)});var U;(U=document.querySelector(".favorites-content-list"))==null||U.addEventListener("click",e=>{if(e.target.classList.contains("delete")){const t=T(e.target);h.removeFromFavorites(t).then(()=>{g.error("Exercise removed from favorites")}).catch(s=>{g.error("Failed to remove exercise from favorites")})}});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("burgerBtn"),t=document.getElementById("burgerMenu"),s=document.getElementById("close-mob-menu"),n=document.querySelector(".social-links"),r=()=>{window.innerWidth<=768?n.style.display="none":n.style.display=""};e.addEventListener("click",()=>{t.classList.add("open")}),s.addEventListener("click",()=>{t.classList.remove("open")}),window.addEventListener("click",o=>{!t.contains(o.target)&&!e.contains(o.target)&&t.classList.remove("open")}),r(),window.addEventListener("resize",r)});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".link-home-btn"),t=document.querySelector(".link-favorites-btn");function s(n,r){n.classList.add("nav-btn-active"),n.classList.remove("nav-btn-inactive"),r.classList.add("nav-btn-inactive"),r.classList.remove("nav-btn-active")}e.addEventListener("click",n=>{s(e,t)}),t.addEventListener("click",n=>{s(t,e)})});const w=document.getElementById("subscribeForm"),q=w.querySelector('input[name="email"]'),N=document.getElementById("subscribeBtn");q.addEventListener("input",Le);w.addEventListener("submit",we);function Q(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Le(){const e=q.value,t=Q(e);q.style.borderColor=t?"green":"red"}async function we(e){e.preventDefault();const s=new FormData(w).get("email");if(!Q(s))return console.error("Invalid email address"),g.error("Invalid email address");N.disabled=!0,h.subscribe(s).then(r=>{w.reset(),q.style.borderColor="",g.success(`${r.data.message}`)}).catch(r=>{var o;return g.error(((o=r==null?void 0:r.data)==null?void 0:o.message)||"Subscription failed")}).finally(()=>{N.disabled=!1})}function z(e){const t=document.getElementById("modal-rating");t.style.display="flex";const s=document.getElementById("subscribe-details-form"),n=document.getElementById("modal-close"),r=document.getElementById("rating-value"),o=document.getElementById("rating-stars");let i=0;o==null||o.addEventListener("click",l=>{const a=o.getBoundingClientRect(),m=(l.clientX-a.left)/a.width;i=Math.round(m*5),r.textContent=i.toFixed(1),c(i)}),o&&r&&(o.addEventListener("mousemove",l=>{const a=o.getBoundingClientRect(),m=(l.clientX-a.left)/a.width,x=Math.round(m*5*10)/10;r.textContent=x.toFixed(1),c(x)}),o.addEventListener("mouseleave",()=>{r.textContent=i.toFixed(1),c(i)}),o.addEventListener("click",l=>{const a=o.getBoundingClientRect(),m=(l.clientX-a.left)/a.width;i=Math.round(m*5*10)/10,r.textContent=i.toFixed(1),c(i)}));function c(l){o.querySelectorAll(".star-icon").forEach((u,m)=>{m<Math.round(l)?u.classList.add("active"):u.classList.remove("active")})}n.addEventListener("click",()=>{t.style.display="none",i=0,r.textContent="0.0",c(0)}),s.addEventListener("submit",async l=>{l.preventDefault();const a="64f389465ae26083f39b17a2",u=s.elements.email,m=s.elements.comment,x=u.value.trim(),X=m.value.trim(),W=i;if(!u.checkValidity()){g.error("Please enter a valid email address.");return}try{const S=await fetch(`https://your-energy.b.goit.study/api/exercises/${a}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:W,email:x,review:X})});if(S.status===409){g.warning("You have already submitted a review for this exercise.");return}else if(S.ok)g.success("Your feedback has been submitted successfully!"),s.reset(),t.style.display="none",i=0,r.textContent="0.0",c(0);else{const Z=await S.json();g.error(`Error ${S.status}: ${Z.message||"Unknown error"}`);return}}catch{g.error("Something went wrong. Please try again later.")}})}async function qe(e){await h.isFavorite(e)?h.removeFromFavorites(e).then(()=>{g.success("Exercise removed from favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),g.error("Failed to remove exercise from favorites")}):h.addToFavorites(e).then(()=>{g.success("Exercise added to favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),g.error("Failed to add exercise to favorites")})}async function Pe(e){var o,i,c;const t=(o=await h.getExerciseById(e))==null?void 0:o.data,s=await h.isFavorite(e);document.querySelector(".modal-title").textContent=t.name,s?(i=document.querySelector(".icon-favorite"))==null||i.classList.add("active"):(c=document.querySelector(".icon-favorite"))==null||c.classList.remove("active"),document.querySelector(".modal-rate-value").textContent=t.rating;const n=document.querySelectorAll(".exercise-info-text"),r=[t.target,t.bodyPart,t.equipment,t.popularity,t.burnedCalories];n.forEach((l,a)=>l.textContent=r[a]),document.querySelector(".modal-img").setAttribute("src",t.gifUrl),document.querySelector(".modal-description").textContent=t.description,document.querySelector(".btn-favorite").onclick=()=>{var l;qe(e),(l=document.querySelector(".icon-favorite"))==null||l.classList.toggle("active")},document.querySelector(".btn-rating").onclick=()=>{R(),z()},document.querySelector(".backdrop").classList.add("is-open"),document.body.classList.add("modal-open")}function R(){document.querySelector(".backdrop").classList.remove("is-open"),document.body.classList.remove("modal-open")}document.querySelector(".modal-close-btn").addEventListener("click",R);document.querySelector(".backdrop").addEventListener("click",e=>{e.target===e.currentTarget&&R()});const I=document.querySelector(".exercises-workout-list");I==null||I.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=T(e.target);Pe(t)}});const B=document.querySelector(".exercises-workout-list");B==null||B.addEventListener("click",e=>{e.target.classList.contains("rating")&&(T(e.target),z())});
//# sourceMappingURL=index.js.map
