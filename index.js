var U=e=>{throw TypeError(e)};var V=(e,t,s)=>t.has(e)||U("Cannot "+s);var y=(e,t,s)=>(V(e,t,"read from private field"),s?s.call(e):t.get(e)),T=(e,t,s)=>t.has(e)?U("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),H=(e,t,s,n)=>(V(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s);import{i as B}from"./assets/vendor-DVYrn7a6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const de=e=>{if(!e||typeof e!="object")return"";const t=Object.fromEntries(Object.entries(e).filter(([n,r])=>r!==void 0));return Object.keys(t).length===0?"":"?"+new URLSearchParams(t).toString()},ue=(e,t)=>(s,{method:n="GET",query:r,body:o})=>new Promise(async(i,l)=>{const d=de(r),a=await fetch(`${e}${s}${d}`,{method:n,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}});if(a.status>=500){l({status:a.status,data:null,error:a.statusText||"Unknown error",isError:!0});return}let u=null;try{u=await a.json()}catch{l({status:500,data:null,error:"Parse error",isError:!0})}if(a.status>=400){l({status:a.status,data:u,error:a.statusText||"Unknown error",isError:!0});return}i({status:a.status,data:u,error:null,isError:!1})}),w=ue("https://your-energy.b.goit.study/api"),fe=async(e,t)=>await w(e,{...t,method:"GET",body:void 0}),ge=async(e,t)=>await w(e,{...t,method:"POST"}),me=async(e,t)=>await w(e,{...t,method:"PUT"}),ye=async(e,t)=>await w(e,{...t,method:"PATCH"}),he=async(e,t)=>await w(e,{...t,method:"DELETE"}),x={get:fe,post:ge,put:me,patch:ye,del:he};function Q(e,t){document.dispatchEvent(new CustomEvent("stateChange",{detail:{branch:e,data:t}}))}const X="favorites";function ve(){const e=localStorage.getItem(X);if(e)try{return JSON.parse(e)}catch(t){return console.error("Error parsing favorites from local storage:",t),[]}return[]}function pe(e){if(!Array.isArray(e)){console.error("Invalid data type for favorites. Expected an array.");return}const t=Array.from(new Set(e.map(s=>s._id))).map(s=>e.find(n=>n._id===s));try{localStorage.setItem(X,JSON.stringify(t))}catch(s){console.error("Error saving favorites to local storage:",s)}}const S={get:ve,set:pe},be=async(e,t=1,s=12)=>x.get("/filters",{query:{filter:e,page:t,limit:s}}),Se=async()=>x.get("/quote"),xe=async(e={})=>x.get("/exercises",{query:{bodypart:e.bodypart,muscles:e.muscles,equipment:e.equipment,keyword:e.keyword,page:e.page||1,limit:e.limit||10}}),Ee=async(e,t)=>x.patch(`/exercises/${e}/rating`,{body:{rate:t.rate,email:t.email,review:t.review}}),W=async e=>x.get(`/exercises/${e}`),Le=async e=>x.post("/subscription",{body:{email:e}}),Pe=async e=>{const t=await W(e);S.set([...S.get(),t.data]);const s=S.get();Q("favorites",s)},qe=async e=>{const t=S.get().filter(s=>s._id!==e);S.set(t),Q("favorites",t)},we=async e=>S.get().some(t=>t._id===e),v={getFilters:be,getQuoteOfDay:Se,getExercises:xe,addExerciseRating:Ee,getExerciseById:W,subscribe:Le,addToFavorites:Pe,removeFromFavorites:qe,isFavorite:we},I={BODY_PARTS:"Body parts",Muscles:"Muscles",Equipment:"Equipment"},Ce={[I.BODY_PARTS]:"bodypart",[I.Muscles]:"muscles",[I.Equipment]:"equipment"},Fe={MAP_GROUPS_TO_QUERY_PARAMS:Ce};var h,p;class ke{constructor(t={}){T(this,h,{});T(this,p,{});H(this,h,{...t}),this.startListening()}startListening(){document.addEventListener("stateChange",t=>{const{branch:s,data:n}=t.detail;console.log("Received new state:",s,n),this.setState(s,n)})}getState(t){return y(this,h)[t]}setState(t,s){y(this,h)[t]!==s&&(y(this,h)[t]=s,this.notify(t))}subscribe(t,s){y(this,p)[t]||(y(this,p)[t]=[]),y(this,p)[t].push(s),s(y(this,h)[t],y(this,h))}notify(t){if(y(this,p)[t])for(const s of y(this,p)[t])s(y(this,h)[t],y(this,h))}}h=new WeakMap,p=new WeakMap;class _e{constructor(){this.subscribers=new Map,window.addEventListener("hashchange",this.handleHashChange.bind(this))}handleHashChange(){const t=window.location.hash;this.subscribers.forEach((s,n)=>{s(t)})}subscribe(t,s){return this.subscribers.has(t)||this.subscribers.set(t,s),()=>{this.subscribers.delete(t)}}isActive(t){return window.location.hash===t}}const M={timeout:3e3,close:!1,closeOnClick:!0,icon:null,position:"topRight",transitionIn:"fadeInDown",transitionOut:"fadeOutUp"};class m{static success(t){B.success({title:"OK",titleColor:"green",message:t,messageColor:"green",progressBarColor:"green",...M})}static error(t){B.error({title:"Error",titleColor:"red",message:t,messageColor:"red",progressBarColor:"red",...M})}static warning(t){B.warning({title:"Caution",message:t,titleColor:"red",messageColor:"red",progressBarColor:"red",...M})}}function Z(e,t=!1){const r=document.querySelector("#templates").content.querySelector(".favorites-workout-card").cloneNode(!0);return r.dataset.id=e._id,t?r.querySelector(".rating").classList.add("hidden"):(r.querySelector(".delete").classList.add("hidden"),r.querySelector(".rating").textContent=e.rating),r.querySelector(".title").textContent=e.name,r.querySelector(".burned-calories").textContent=`${e.burnedCalories} / ${e.time} min`,r.querySelector(".group").textContent=e._group,r.querySelector(".group-target").textContent=e.bodyPart,r.querySelector(".filter").textContent=e.target,r}function ee(e,t){const s=document.querySelector(".exercises-workout-list");if(!t){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.innerHTML="",e.forEach(n=>{const r=Z(n);s.appendChild(r)})}function Te(e){const t=document.querySelector(".favorites-content-list"),s=t==null?void 0:t.querySelector(".favorites-list"),n=t==null?void 0:t.querySelector(".favorites-empty-message");if(s.innerHTML="",e.length===0){n.classList.remove("hidden"),s.classList.add("hidden");return}n.classList.add("hidden"),s.classList.remove("hidden"),e.forEach(r=>{const o=Z(r,!0);s.appendChild(o)})}function Be(e,{group:t,filter:s,image:n}){const o=document.querySelector("#templates").content.querySelector(".exercises-card-filter");let i=o==null?void 0:o.getAttribute("style");if(i=i.replace("{=$image}",`${n}`),e)e.setAttribute("style",i),e.querySelector("h3").textContent=s,e.querySelector("h3").setAttribute("data-filter",s),e.querySelector("div").textContent=t,e.querySelector("div").setAttribute("data-group",t);else{const l=o.cloneNode(!0);return l.setAttribute("style",i),l.querySelector("h3").textContent=s,l.querySelector("h3").setAttribute("data-filter",s),l.querySelector("div").textContent=t,l.querySelector("div").setAttribute("data-group",t),l}}const j=12;function te(e,t){var n;const s=document.querySelector(".exercises-filters-list");if(t){s==null||s.classList.add("hidden");return}if(s==null||s.classList.remove("hidden"),e.forEach((r,o)=>{const{filter:i,imgURL:l,name:d}=r;s.children[o]&&(s.children[o].classList.remove("hidden"),Be(s.children[o],{filter:d,image:l,group:i}))}),e.length<j){const r=j-e.length;for(let o=0;o<r;o++)(n=s==null?void 0:s.children[o+e.length])==null||n.classList.add("hidden")}}function K(e,t){const s=document.getElementById("exercises-list-pagination-buttons");if(!t||t<=1||t=="1"){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.querySelector(".arrow-buttons-left"),s.querySelector(".arrow-buttons-right");const n=s.querySelector(".page-buttons");n.innerHTML="";for(let r=1;r<=t;r++){const o=document.createElement("button");o.dataset.page=r,o.className="page-button",o.textContent=r,r==e&&o.classList.add("active"),n.appendChild(o)}}function _(e){if(!e)return null;for(;e&&!e.dataset.id;)e=e.parentElement;return e?e.dataset.id:null}const se=new _e,c=new ke({loading:!1,selectedGroup:"Muscles",selectedFilter:null,filtersPage:1,filtersPerPage:12,filtersTotalPages:null,filters:[],exercises:[],exercisesPage:1,exercisesPerPage:10,exercisesTotalPages:null,showFavorites:se.isActive("#favorites"),favorites:S.get()||[]});se.subscribe("main",e=>{console.log("Main hash changed:",e);const t={"#favorites":()=>c.setState("showFavorites",!0),"":()=>c.setState("showFavorites",!1)};try{t[e]()}catch{console.error("Not implemented action for hash:",e)}});c.subscribe("showFavorites",(e,t)=>{console.log("Show favorites state changed:",e);const s=document.querySelector("#favorites-content"),n=document.querySelector("main");e?(n==null||n.classList.add("hidden"),s.classList.remove("hidden"),s.style.setProperty("--height",`${window.innerHeight}px`)):(n==null||n.classList.remove("hidden"),s.classList.add("hidden"))});const C=document.querySelector(".tabs-controls");C.addEventListener("click",e=>{var t;if(e.target.dataset.group){(t=C==null?void 0:C.querySelector(".active"))==null||t.classList.remove("active"),e.target.classList.add("active");const s=e.target.dataset.group;console.log("Selected category:",s),c.setState("selectedGroup",s),c.setState("selectedFilter",null)}});function N(e,t,s){return`${e}-${t}-${s}`}let P=!1;async function re(e){if(P){console.log("Filters are already being updated, skipping this call");return}P=!0;const{selectedGroup:t}=e;console.log("Selected category changed:",t);const s=N(e.filtersPerPage,e.filtersPage,t),n=e.filters.find(a=>a._key===s);if(n){console.log("Filters already loaded for this group:",t,e.filters),c.setState("filters",[...e.filters]),c.setState("filtersTotalPages",n._total),P=!1;return}const r=await v.getFilters(t,e.filtersPage);if(console.log("Filters data:",t,r,e),r.isError){console.error("Error fetching filters:",r.error),P=!1;return}const{results:o,page:i,perPage:l,totalPages:d}=r.data;c.setState("filters",[...e.filters,...o.map(a=>({...a,_key:N(l,i,t),_total:d}))]),c.setState("filtersPerPage",l),c.setState("filtersTotalPages",d),P=!1}c.subscribe("selectedGroup",(e,t)=>re(t));c.subscribe("filtersPage",(e,t)=>re(t));c.subscribe("filters",(e,t)=>{const{filtersPerPage:s,filtersPage:n,selectedGroup:r}=t,o=e.filter(i=>i._key===N(s,n,r));console.log("Filters list:",o),te(o)});c.subscribe("selectedFilter",(e,t)=>{e&&te(null,e)});const A=document.querySelector(".exercises-filters-list");A==null||A.addEventListener("click",e=>{if(e.target.classList.contains("exercises-card-filter")){const t=e.target.querySelector("[data-filter]").dataset.filter;console.log("Selected filter:",t),c.setState("selectedFilter",t)}});function D(e,t,s,n){return`${e}-${t}-${s}-${n}`}let q=!1;async function oe(e){if(q){console.log("Exercises are already being updated, skipping this call");return}q=!0;const{selectedFilter:t}=e;if(!t){console.log("No filter selected, skipping exercises fetch"),q=!1;return}const s=D(e.exercisesPerPage,e.exercisesPage,e.selectedGroup,t),n=e.exercises.find(i=>i._key===s);if(n){console.log("Exercises already loaded for this filter:",t,e.exercises),c.setState("exercises",[...e.exercises]),c.setState("exercisesTotalPages",n._total),q=!1;return}const o={[Fe.MAP_GROUPS_TO_QUERY_PARAMS[e.selectedGroup]]:t,page:e.exercisesPage,limit:e.exercisesPerPage};v.getExercises(o).then(i=>{if(i.isError){console.error("Error fetching exercises:",i.error);return}const{results:l,page:d,perPage:a,totalPages:u}=i.data;console.log("Exercises data:",i.data),c.setState("exercises",[...e.exercises,...l.map(g=>({...g,_group:e.selectedGroup,_key:D(a,d,e.selectedGroup,t),_total:u}))]),c.setState("exercisesPerPage",a),c.setState("exercisesTotalPages",u),q=!1})}c.subscribe("selectedFilter",(e,t)=>oe(t));c.subscribe("exercisesPage",(e,t)=>oe(t));c.subscribe("exercises",(e,t)=>{const{exercisesPerPage:s,exercisesPage:n,selectedGroup:r,selectedFilter:o}=t,i=e.filter(l=>l._key===D(s,n,r,o));console.log("Exercises list:",{exercises:e,list:i}),ee(i,o)});c.subscribe("selectedFilter",(e,t)=>{e||ee(!1,e)});c.subscribe("favorites",(e,t)=>{console.log("Favorites list:",e),Te(e)});var z;(z=document.querySelector(".favorites-content-list"))==null||z.addEventListener("click",e=>{if(e.target.classList.contains("delete")){const t=_(e.target);v.removeFromFavorites(t).then(()=>{m.success("Exercise removed from favorites")}).catch(s=>{m.error("Failed to remove exercise from favorites")})}});function E(e){const{selectedFilter:t}=e;t?K(e.exercisesPage,e.exercisesTotalPages):K(e.filtersPage,e.filtersTotalPages)}c.subscribe("filtersTotalPages",(e,t)=>E(t));c.subscribe("filtersPage",(e,t)=>E(t));c.subscribe("exercisesTotalPages",(e,t)=>E(t));c.subscribe("exercisesPage",(e,t)=>E(t));c.subscribe("selectedGroup",(e,t)=>E(t));c.subscribe("selectedFilter",(e,t)=>E(t));var J;(J=document.querySelector(".page-buttons"))==null||J.addEventListener("click",e=>{const t=e.target.dataset.page;t&&(c.getState("selectedFilter")?c.setState("exercisesPage",Number(t)):c.setState("filtersPage",Number(t)))});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("burgerBtn"),t=document.getElementById("burgerMenu"),s=document.getElementById("close-mob-menu"),n=document.querySelector(".social-links"),r=document.querySelector(".link-home-btn"),o=document.querySelector(".link-favorites-btn"),i=document.querySelector(".link-home-mobile"),l=document.querySelector(".link-favorites-mobile");function d(f,b){f.classList.add("nav-btn-active"),f.classList.remove("nav-btn-inactive"),b.classList.add("nav-btn-inactive"),b.classList.remove("nav-btn-active")}function a(){document.querySelector("#favorites-content")&&!document.querySelector("#favorites-content").classList.contains("hidden")?(d(o,r),d(l,i)):(d(r,o),d(i,l))}function u(f=!1){const b=document.getElementById("favorites-content");b&&(b.classList.toggle("hidden",!f),t.classList.remove("open"),a())}r.addEventListener("click",()=>u(!1)),o.addEventListener("click",()=>u(!0)),i.addEventListener("click",()=>u(!1)),l.addEventListener("click",()=>u(!0)),e.addEventListener("click",()=>{t.classList.add("open")}),s.addEventListener("click",()=>{t.classList.remove("open")}),window.addEventListener("click",f=>{!t.contains(f.target)&&!e.contains(f.target)&&t.classList.remove("open")});const g=()=>{window.innerWidth<=768?n.style.display="none":n.style.display=""};document.querySelectorAll(".link-icon").forEach(f=>{f.addEventListener("click",()=>{f.blur()})}),g(),window.addEventListener("resize",()=>{g(),a()}),window.addEventListener("hashchange",a),a()});const F=document.getElementById("subscribeForm"),k=F.querySelector('input[name="email"]'),Y=document.getElementById("subscribeBtn");k.addEventListener("input",Ie);F.addEventListener("submit",Me);function ne(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ie(){const e=k.value,t=ne(e);k.style.borderColor=t?"green":"red"}async function Me(e){e.preventDefault();const s=new FormData(F).get("email");if(!ne(s))return console.error("Invalid email address"),m.error("Invalid email address");Y.disabled=!0,v.subscribe(s).then(r=>{F.reset(),k.style.borderColor="",m.success(`${r.data.message}`)}).catch(r=>{var o;return m.error(((o=r==null?void 0:r.data)==null?void 0:o.message)||"Subscription failed")}).finally(()=>{Y.disabled=!1})}function ie(e){const t=document.getElementById("modal-rating");t.style.display="flex";const s=document.getElementById("subscribe-details-form"),n=document.getElementById("modal-close"),r=document.getElementById("rating-value"),o=document.getElementById("rating-stars");let i=0;o==null||o.addEventListener("click",d=>{const a=o.getBoundingClientRect(),g=(d.clientX-a.left)/a.width;i=Math.round(g*5),r.textContent=i.toFixed(1),l(i)}),o&&r&&(o.addEventListener("mousemove",d=>{const a=o.getBoundingClientRect(),g=(d.clientX-a.left)/a.width,f=Math.round(g*5*10)/10;r.textContent=f.toFixed(1),l(f)}),o.addEventListener("mouseleave",()=>{r.textContent=i.toFixed(1),l(i)}),o.addEventListener("click",d=>{const a=o.getBoundingClientRect(),g=(d.clientX-a.left)/a.width;i=Math.round(g*5*10)/10,r.textContent=i.toFixed(1),l(i)}));function l(d){o.querySelectorAll(".star-icon").forEach((u,g)=>{g<Math.round(d)?u.classList.add("active"):u.classList.remove("active")})}n.addEventListener("click",()=>{t.style.display="none",i=0,r.textContent="0.0",l(0)}),s.addEventListener("submit",async d=>{d.preventDefault();const a="64f389465ae26083f39b17a2",u=s.elements.email,g=s.elements.comment,f=u.value.trim(),b=g.value.trim(),ce=i;if(!u.checkValidity()){m.error("Please enter a valid email address.");return}try{const L=await fetch(`https://your-energy.b.goit.study/api/exercises/${a}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:ce,email:f,review:b})});if(L.status===409){m.warning("You have already submitted a review for this exercise.");return}else if(L.ok)m.success("Your feedback has been submitted successfully!"),s.reset(),t.style.display="none",i=0,r.textContent="0.0",l(0);else{const le=await L.json();m.error(`Error ${L.status}: ${le.message||"Unknown error"}`);return}}catch{m.error("Something went wrong. Please try again later.")}})}async function Ae(e){await v.isFavorite(e)?v.removeFromFavorites(e).then(()=>{m.success("Exercise removed from favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),m.error("Failed to remove exercise from favorites")}):v.addToFavorites(e).then(()=>{m.success("Exercise added to favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),m.error("Failed to add exercise to favorites")})}async function ae(e){var o,i,l;const t=(o=await v.getExerciseById(e))==null?void 0:o.data,s=await v.isFavorite(e);document.querySelector(".modal-title").textContent=t.name,s?(i=document.querySelector(".icon-favorite"))==null||i.classList.add("active"):(l=document.querySelector(".icon-favorite"))==null||l.classList.remove("active"),document.querySelector(".modal-rate-value").textContent=t.rating;const n=document.querySelectorAll(".exercise-info-text"),r=[t.target,t.bodyPart,t.equipment,t.popularity,t.burnedCalories];n.forEach((d,a)=>d.textContent=r[a]),document.querySelector(".modal-img").setAttribute("src",t.gifUrl),document.querySelector(".modal-description").textContent=t.description,document.querySelector(".btn-favorite").onclick=()=>{var d;Ae(e),(d=document.querySelector(".icon-favorite"))==null||d.classList.toggle("active")},document.querySelector(".btn-rating").onclick=()=>{G(),ie()},document.querySelector(".backdrop").classList.add("is-open"),document.body.classList.add("modal-open")}function G(){document.querySelector(".backdrop").classList.remove("is-open"),document.body.classList.remove("modal-open")}document.querySelector(".modal-close-btn").addEventListener("click",G);document.querySelector(".backdrop").addEventListener("click",e=>{e.target===e.currentTarget&&G()});const O=document.querySelector(".exercises-workout-list");O==null||O.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=_(e.target);ae(t)}});const R=document.querySelector(".favorites-list");R==null||R.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=_(e.target);ae(t)}});const $=document.querySelector(".exercises-workout-list");$==null||$.addEventListener("click",e=>{e.target.classList.contains("rating")&&(_(e.target),ie())});
//# sourceMappingURL=index.js.map
