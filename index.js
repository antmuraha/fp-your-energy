var j=e=>{throw TypeError(e)};var K=(e,t,s)=>t.has(e)||j("Cannot "+s);var m=(e,t,s)=>(K(e,t,"read from private field"),s?s.call(e):t.get(e)),M=(e,t,s)=>t.has(e)?j("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),Y=(e,t,s,i)=>(K(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s);import{i as A}from"./assets/vendor-DVYrn7a6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const ge=e=>{if(!e||typeof e!="object")return"";const t=Object.fromEntries(Object.entries(e).filter(([i,r])=>r!==void 0));return Object.keys(t).length===0?"":"?"+new URLSearchParams(t).toString()},me=(e,t)=>(s,{method:i="GET",query:r,body:o})=>new Promise(async(n,l)=>{const d=ge(r),c=await fetch(`${e}${s}${d}`,{method:i,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}});if(c.status>=500){l({status:c.status,data:null,error:c.statusText||"Unknown error",isError:!0});return}let u=null;try{u=await c.json()}catch{l({status:500,data:null,error:"Parse error",isError:!0})}if(c.status>=400){l({status:c.status,data:u,error:c.statusText||"Unknown error",isError:!0});return}n({status:c.status,data:u,error:null,isError:!1})}),w=me("https://your-energy.b.goit.study/api"),he=async(e,t)=>await w(e,{...t,method:"GET",body:void 0}),ye=async(e,t)=>await w(e,{...t,method:"POST"}),ve=async(e,t)=>await w(e,{...t,method:"PUT"}),pe=async(e,t)=>await w(e,{...t,method:"PATCH"}),be=async(e,t)=>await w(e,{...t,method:"DELETE"}),L={get:he,post:ye,put:ve,patch:pe,del:be};function te(e,t){document.dispatchEvent(new CustomEvent("stateChange",{detail:{branch:e,data:t}}))}const se="favorites";function Se(){const e=localStorage.getItem(se);if(e)try{return JSON.parse(e)}catch(t){return console.error("Error parsing favorites from local storage:",t),[]}return[]}function Le(e){if(!Array.isArray(e)){console.error("Invalid data type for favorites. Expected an array.");return}const t=Array.from(new Set(e.map(s=>s._id))).map(s=>e.find(i=>i._id===s));try{localStorage.setItem(se,JSON.stringify(t))}catch(s){console.error("Error saving favorites to local storage:",s)}}const b={get:Se,set:Le},xe=async(e,t=1,s=12)=>L.get("/filters",{query:{filter:e,page:t,limit:s}}),Ee=async()=>L.get("/quote"),qe=async(e={})=>L.get("/exercises",{query:{bodypart:e.bodypart,muscles:e.muscles,equipment:e.equipment,keyword:e.keyword,page:e.page||1,limit:e.limit||10}}),Pe=async(e,t)=>L.patch(`/exercises/${e}/rating`,{body:{rate:t.rate,email:t.email,review:t.review}}),re=async e=>L.get(`/exercises/${e}`),we=async e=>L.post("/subscription",{body:{email:e}}),Fe=async e=>{const t=await re(e);b.set([...b.get(),t.data]);const s=b.get();te("favorites",s)},Ce=async e=>{const t=b.get().filter(s=>s._id!==e);b.set(t),te("favorites",t)},ke=async e=>b.get().some(t=>t._id===e),v={getFilters:xe,getQuoteOfDay:Ee,getExercises:qe,addExerciseRating:Pe,getExerciseById:re,subscribe:we,addToFavorites:Fe,removeFromFavorites:Ce,isFavorite:ke},B={BODY_PARTS:"Body parts",Muscles:"Muscles",Equipment:"Equipment"},Te={[B.BODY_PARTS]:"bodypart",[B.Muscles]:"muscles",[B.Equipment]:"equipment"},_e={MAP_GROUPS_TO_QUERY_PARAMS:Te};var y,p;class Me{constructor(t={}){M(this,y,{});M(this,p,{});Y(this,y,{...t}),this.startListening()}startListening(){document.addEventListener("stateChange",t=>{const{branch:s,data:i}=t.detail;console.log("Received new state:",s,i),this.setState(s,i)})}getState(t){return m(this,y)[t]}setState(t,s){m(this,y)[t]!==s&&(m(this,y)[t]=s,this.notify(t))}subscribe(t,s){m(this,p)[t]||(m(this,p)[t]=[]),m(this,p)[t].push(s),s(m(this,y)[t],m(this,y))}notify(t){if(m(this,p)[t])for(const s of m(this,p)[t])s(m(this,y)[t],m(this,y))}}y=new WeakMap,p=new WeakMap;class Ae{constructor(){this.subscribers=new Map,window.addEventListener("hashchange",this.handleHashChange.bind(this))}handleHashChange(){const t=window.location.hash;this.subscribers.forEach((s,i)=>{s(t)})}subscribe(t,s){return this.subscribers.has(t)||this.subscribers.set(t,s),()=>{this.subscribers.delete(t)}}isActive(t){return window.location.hash===t}}function Be(e){const t=document.getElementById("burgerBtn"),s=document.getElementById("burgerMenu"),i=document.getElementById("close-mob-menu"),r=document.querySelector(".social-links"),o=document.querySelector(".link-home-btn"),n=document.querySelector(".link-favorites-btn"),l=document.querySelector(".link-home-mobile"),d=document.querySelector(".link-favorites-mobile");function c(h,F){h.classList.add("nav-btn-active"),h.classList.remove("nav-btn-inactive"),F.classList.add("nav-btn-inactive"),F.classList.remove("nav-btn-active")}function u(){e.isActive("#favorites")?(c(n,o),c(d,l)):(c(o,n),c(l,d))}function f(h=!1){s.classList.remove("open"),setTimeout(u,50)}o.addEventListener("click",()=>f(!1)),n.addEventListener("click",()=>f(!0)),l.addEventListener("click",()=>f(!1)),d.addEventListener("click",()=>f(!0)),t.addEventListener("click",()=>{s.classList.add("open")}),i.addEventListener("click",()=>{s.classList.remove("open")}),window.addEventListener("click",h=>{!s.contains(h.target)&&!t.contains(h.target)&&s.classList.remove("open")});const S=()=>{window.innerWidth<=768?r.style.display="none":r.style.display=""};document.querySelectorAll(".link-icon").forEach(h=>{h.addEventListener("click",()=>{h.blur()})}),S(),u()}const I={timeout:3e3,close:!1,closeOnClick:!0,icon:null,position:"topRight",transitionIn:"fadeInDown",transitionOut:"fadeOutUp"};class g{static success(t){A.success({title:"OK",titleColor:"green",message:t,messageColor:"green",progressBarColor:"green",...I})}static error(t){A.error({title:"Error",titleColor:"red",message:t,messageColor:"red",progressBarColor:"red",...I})}static warning(t){A.warning({title:"Caution",message:t,titleColor:"red",messageColor:"red",progressBarColor:"red",...I})}}function oe(e,t=!1){const r=document.querySelector("#templates").content.querySelector(".favorites-workout-card").cloneNode(!0);return r.dataset.id=e._id,t?(r.querySelector(".delete").classList.remove("hidden"),r.querySelector(".favorites-workout-card-rating-container").classList.add("hidden")):(r.querySelector(".delete").classList.add("hidden"),r.querySelector(".rating-value").textContent=e.rating,r.querySelector(".favorites-workout-card-rating-container").classList.remove("hidden")),r.querySelector(".title").textContent=e.name,r.querySelector(".burned-calories").textContent=`${e.burnedCalories} / ${e.time} min`,r.querySelector(".group").textContent=e._group,r.querySelector(".group-target").textContent=e.bodyPart,r.querySelector(".filter").textContent=e.target,r}function ie(e,t){const s=document.querySelector(".exercises-workout-list");if(!t){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.innerHTML="",e.forEach(i=>{const r=oe(i);s.appendChild(r)}),(e==null?void 0:e.length)===0?document.querySelector(".exercises-empty-message").classList.remove("hidden"):document.querySelector(".exercises-empty-message").classList.add("hidden")}function Ie(e){const t=document.querySelector(".exercises-header-container");if(e){t.querySelector(".filter").textContent=e||"",t.classList.remove("hidden");return}t.classList.add("hidden")}function $e(e){const t=document.querySelector(".favorites-content-list"),s=t==null?void 0:t.querySelector(".favorites-list"),i=t==null?void 0:t.querySelector(".favorites-empty-message");if(s.innerHTML="",e.length===0){i.classList.remove("hidden"),s.classList.add("hidden");return}i.classList.add("hidden"),s.classList.remove("hidden"),e.forEach(r=>{const o=oe(r,!0);s.appendChild(o)})}function Oe(e,{group:t,filter:s,image:i}){const o=document.querySelector("#templates").content.querySelector(".exercises-card-filter");let n=o==null?void 0:o.getAttribute("style");if(n=n.replace("{=$image}",`${i}`),e)e.setAttribute("style",n),e.querySelector("h3").textContent=z(s),e.querySelector("h3").setAttribute("data-filter",s),e.querySelector("div").textContent=t,e.querySelector("div").setAttribute("data-group",t);else{const l=o.cloneNode(!0);return l.setAttribute("style",n),l.querySelector("h3").textContent=z(s),l.querySelector("h3").setAttribute("data-filter",s),l.querySelector("div").textContent=t,l.querySelector("div").setAttribute("data-group",t),l}}function z(e){return typeof e=="string"?`${e.charAt(0).toUpperCase()}${e.slice(1)}`:e}const J=12;function ne(e,t){var i;const s=document.querySelector(".exercises-filters-list");if(t){s==null||s.classList.add("hidden");return}if(s==null||s.classList.remove("hidden"),e.forEach((r,o)=>{const{filter:n,imgURL:l,name:d}=r;s.children[o]&&(s.children[o].classList.remove("hidden"),Oe(s.children[o],{filter:d,image:l,group:n}))}),e.length<J){const r=J-e.length;for(let o=0;o<r;o++)(i=s==null?void 0:s.children[o+e.length])==null||i.classList.add("hidden")}}function Q(e,t){const s=document.getElementById("exercises-list-pagination-buttons");if(!t||t<=1||t=="1"){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.querySelector(".arrow-buttons-left"),s.querySelector(".arrow-buttons-right");const i=s.querySelector(".page-buttons");i.innerHTML="";for(let r=1;r<=t;r++){const o=document.createElement("button");o.dataset.page=r,o.className="page-button",o.textContent=r,r==e&&o.classList.add("active"),i.appendChild(o)}}function Re(e){const t=document.querySelector(".search-field"),s=t==null?void 0:t.querySelector(".search-input");e?(t==null||t.classList.remove("hidden"),s==null||s.setAttribute("value","")):t==null||t.classList.add("hidden")}const Ne=500;function Ge(e,t){const s=document.querySelector(".search-field"),i=s==null?void 0:s.querySelector(".search-input"),r=s==null?void 0:s.querySelector(".clear-button"),o=s==null?void 0:s.querySelector(".search-icon");i.value="",r.classList.add("hidden"),o.classList.remove("hidden");let n;i.addEventListener("input",d=>{const c=d.target.value.trim();clearTimeout(n),n=setTimeout(()=>{t(c)},Ne),r.classList.toggle("hidden",!c),o.classList.toggle("hidden",!!c)}),r.addEventListener("click",()=>{i.value="",r.classList.add("hidden"),o.classList.remove("hidden"),t(""),i.focus()}),new MutationObserver(()=>{const d=(i.getAttribute("value")||"").trim();i.value=d,t(d),r.classList.toggle("hidden",!d),o.classList.toggle("hidden",!!d)}).observe(i,{attributes:!0,attributeFilter:["value"]})}function _(e){if(!e)return null;for(;e&&!e.dataset.id;)e=e.parentElement;return e?e.dataset.id:null}const D=new Ae,ce=D.isActive("#favorites"),a=new Me({loading:!1,search:"",selectedGroup:"Muscles",selectedFilter:null,filtersPage:1,filtersPerPage:12,filtersTotalPages:null,filters:[],exercises:[],exercisesPage:1,exercisesPerPage:10,exercisesTotalPages:null,showFavorites:ce,favorites:b.get()||[]});ce&&document.body.classList.add("modal-open");D.subscribe("main",e=>{console.log("Main hash changed:",e);const t={"#favorites":()=>{a.setState("showFavorites",!0),document.body.classList.add("modal-open")},"":()=>{a.setState("showFavorites",!1),document.body.classList.remove("modal-open")}};try{t[e]()}catch{console.error("Not implemented action for hash:",e)}});Be(D);a.subscribe("showFavorites",(e,t)=>{console.log("Show favorites state changed:",e);const s=document.querySelector("#favorites"),i=document.querySelector("main");e?(i==null||i.classList.add("hidden"),s.classList.remove("hidden"),s.style.setProperty("--height",`${window.innerHeight}px`)):(i==null||i.classList.remove("hidden"),s.classList.add("hidden"))});const C=document.querySelector(".tabs-controls");C.addEventListener("click",e=>{var t;if(e.target.dataset.group){(t=C==null?void 0:C.querySelector(".active"))==null||t.classList.remove("active"),e.target.classList.add("active");const s=e.target.dataset.group;console.log("Selected category:",s),a.setState("selectedGroup",s),a.setState("selectedFilter",null)}});function G(e,t,s){return`${e}-${t}-${s}`}let q=!1;async function ae(e){if(q){console.log("Filters are already being updated, skipping this call");return}q=!0;const{selectedGroup:t}=e;console.log("Selected category changed:",t);const s=G(e.filtersPerPage,e.filtersPage,t),i=e.filters.find(c=>c._key===s);if(i){console.log("Filters already loaded for this group:",t,e.filters),a.setState("filters",[...e.filters]),a.setState("filtersTotalPages",i._total),q=!1;return}const r=await v.getFilters(t,e.filtersPage);if(console.log("Filters data:",t,r,e),r.isError){console.error("Error fetching filters:",r.error),q=!1;return}const{results:o,page:n,perPage:l,totalPages:d}=r.data;a.setState("filters",[...e.filters,...o.map(c=>({...c,_key:G(l,n,t),_total:d}))]),a.setState("filtersPerPage",l),a.setState("filtersTotalPages",d),q=!1}a.subscribe("selectedGroup",(e,t)=>ae(t));a.subscribe("filtersPage",(e,t)=>ae(t));a.subscribe("selectedFilter",Ie);Ge("",e=>a.setState("search",e));a.subscribe("selectedFilter",e=>Re(!!e));a.subscribe("filters",(e,t)=>{const{filtersPerPage:s,filtersPage:i,selectedGroup:r}=t,o=e.filter(n=>n._key===G(s,i,r));console.log("Filters list:",o),ne(o)});a.subscribe("selectedFilter",(e,t)=>{e&&ne(null,e)});const $=document.querySelector(".exercises-filters-list");$==null||$.addEventListener("click",e=>{if(e.target.classList.contains("exercises-card-filter")){const t=e.target.querySelector("[data-filter]").dataset.filter;console.log("Selected filter:",t),a.setState("selectedFilter",t)}});function U(e,t,s,i,r=""){return`${e}-${t}-${s}-${i}-${r}`}let P=!1;async function H(e){if(P){console.log("Exercises are already being updated, skipping this call");return}P=!0;const{selectedFilter:t}=e;if(!t){console.log("No filter selected, skipping exercises fetch"),P=!1;return}const s=U(e.exercisesPerPage,e.exercisesPage,e.selectedGroup,t,e.search),i=e.exercises.find(n=>n._key===s);if(i){console.log("Exercises already loaded for this filter:",t,e.exercises),a.setState("exercises",[...e.exercises]),a.setState("exercisesTotalPages",i._total),P=!1;return}const o={[_e.MAP_GROUPS_TO_QUERY_PARAMS[e.selectedGroup]]:t,page:e.exercisesPage,limit:e.exercisesPerPage,keyword:e.search};v.getExercises(o).then(n=>{if(n.isError){console.error("Error fetching exercises:",n.error);return}const{results:l,page:d,perPage:c,totalPages:u}=n.data;console.log("Exercises data:",n.data),a.setState("exercises",[...e.exercises,...l.map(f=>({...f,_group:e.selectedGroup,_key:U(c,d,e.selectedGroup,t,e.search),_total:u}))]),a.setState("exercisesPerPage",c),a.setState("exercisesTotalPages",u),P=!1})}a.subscribe("selectedFilter",(e,t)=>H(t));a.subscribe("exercisesPage",(e,t)=>H(t));a.subscribe("search",(e,t)=>H(t));a.subscribe("exercises",(e,t)=>{const{exercisesPerPage:s,exercisesPage:i,selectedGroup:r,selectedFilter:o,search:n}=t,l=e.filter(d=>d._key===U(s,i,r,o,n));console.log("Exercises list:",{exercises:e,list:l}),ie(l,o)});a.subscribe("selectedFilter",(e,t)=>{e||ie(!1,e)});a.subscribe("favorites",(e,t)=>{console.log("Favorites list:",e),$e(e)});var Z;(Z=document.querySelector(".favorites-content-list"))==null||Z.addEventListener("click",e=>{if(e.target.classList.contains("delete")){const t=_(e.target);v.removeFromFavorites(t).then(()=>{g.success("Exercise removed from favorites")}).catch(s=>{g.error("Failed to remove exercise from favorites")})}});function x(e){const{selectedFilter:t}=e;t?Q(e.exercisesPage,e.exercisesTotalPages):Q(e.filtersPage,e.filtersTotalPages)}a.subscribe("filtersTotalPages",(e,t)=>x(t));a.subscribe("filtersPage",(e,t)=>x(t));a.subscribe("exercisesTotalPages",(e,t)=>x(t));a.subscribe("exercisesPage",(e,t)=>x(t));a.subscribe("selectedGroup",(e,t)=>x(t));a.subscribe("selectedFilter",(e,t)=>x(t));var ee;(ee=document.querySelector(".page-buttons"))==null||ee.addEventListener("click",e=>{const t=e.target.dataset.page;t&&(a.getState("selectedFilter")?a.setState("exercisesPage",Number(t)):a.setState("filtersPage",Number(t)))});const k=document.getElementById("subscribeForm"),T=k.querySelector('input[name="email"]'),X=document.getElementById("subscribeBtn");T.addEventListener("input",Ue);k.addEventListener("submit",De);function le(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ue(){const e=T.value,t=le(e);T.style.borderColor=t?"green":"red"}async function De(e){e.preventDefault();const s=new FormData(k).get("email");if(!le(s))return console.error("Invalid email address"),g.error("Invalid email address");X.disabled=!0,v.subscribe(s).then(r=>{k.reset(),T.style.borderColor="",g.success(`${r.data.message}`)}).catch(r=>{var o;return g.error(((o=r==null?void 0:r.data)==null?void 0:o.message)||"Subscription failed")}).finally(()=>{X.disabled=!1})}function de(e){const t=document.getElementById("modal-rating");t.style.display="flex";const s=document.getElementById("subscribe-details-form"),i=document.getElementById("modal-close"),r=document.getElementById("rating-value"),o=document.getElementById("rating-stars");let n=0;o==null||o.addEventListener("click",d=>{const c=o.getBoundingClientRect(),f=(d.clientX-c.left)/c.width;n=Math.round(f*5),r.textContent=n.toFixed(1),l(n)}),o&&r&&(o.addEventListener("mousemove",d=>{const c=o.getBoundingClientRect(),f=(d.clientX-c.left)/c.width,S=Math.round(f*5*10)/10;r.textContent=S.toFixed(1),l(S)}),o.addEventListener("mouseleave",()=>{r.textContent=n.toFixed(1),l(n)}),o.addEventListener("click",d=>{const c=o.getBoundingClientRect(),f=(d.clientX-c.left)/c.width;n=Math.round(f*5*10)/10,r.textContent=n.toFixed(1),l(n)}));function l(d){o.querySelectorAll(".star-icon").forEach((u,f)=>{f<Math.round(d)?u.classList.add("active"):u.classList.remove("active")})}i.addEventListener("click",()=>{t.style.display="none",n=0,r.textContent="0.0",l(0)}),s.addEventListener("submit",async d=>{d.preventDefault();const c="64f389465ae26083f39b17a2",u=s.elements.email,f=s.elements.comment,S=u.value.trim(),h=f.value.trim(),F=n;if(!u.checkValidity()){g.error("Please enter a valid email address.");return}try{const E=await fetch(`https://your-energy.b.goit.study/api/exercises/${c}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:F,email:S,review:h})});if(E.status===409){g.warning("You have already submitted a review for this exercise.");return}else if(E.ok)g.success("Your feedback has been submitted successfully!"),s.reset(),t.style.display="none",n=0,r.textContent="0.0",l(0);else{const fe=await E.json();g.error(`Error ${E.status}: ${fe.message||"Unknown error"}`);return}}catch{g.error("Something went wrong. Please try again later.")}})}async function He(e){await v.isFavorite(e)?v.removeFromFavorites(e).then(()=>{g.success("Exercise removed from favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),g.error("Failed to remove exercise from favorites")}):v.addToFavorites(e).then(()=>{g.success("Exercise added to favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),g.error("Failed to add exercise to favorites")})}function W(e){return typeof e=="string"?`${e.charAt(0).toUpperCase()}${e.slice(1)}`:e}async function ue(e){var n,l,d;const t=(n=await v.getExerciseById(e))==null?void 0:n.data,s=await v.isFavorite(e);document.querySelector(".modal-title").textContent=W(t.name),s?(l=document.querySelector(".icon-favorite"))==null||l.classList.add("active"):(d=document.querySelector(".icon-favorite"))==null||d.classList.remove("active"),document.querySelector(".modal-rate-value").textContent=t.rating;const i=document.querySelectorAll(".exercise-info-text"),r=[t.target,t.bodyPart,t.equipment,t.popularity,t.burnedCalories];i.forEach((c,u)=>c.textContent=W(r[u])),document.querySelector(".modal-img").setAttribute("src",t.gifUrl),document.querySelector(".modal-description").textContent=t.description,document.querySelector(".btn-favorite").onclick=()=>{var c;He(e),(c=document.querySelector(".icon-favorite"))==null||c.classList.toggle("active")},document.querySelector(".btn-rating").onclick=()=>{V(),de()},document.querySelector(".backdrop").classList.add("is-open"),document.body.classList.add("modal-open");const o=document.querySelectorAll(".star-rating-icon");for(let c=0;c<Math.round(t.rating);++c)o[c].style.fill="#eea10c"}function V(){document.querySelector(".backdrop").classList.remove("is-open"),document.body.classList.remove("modal-open")}document.querySelector(".modal-close-btn").addEventListener("click",V);document.querySelector(".backdrop").addEventListener("click",e=>{e.target===e.currentTarget&&V()});const O=document.querySelector(".exercises-workout-list");O==null||O.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=_(e.target);ue(t)}});const R=document.querySelector(".favorites-list");R==null||R.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=_(e.target);ue(t)}});const N=document.querySelector(".exercises-workout-list");N==null||N.addEventListener("click",e=>{e.target.classList.contains("rating")&&(_(e.target),de())});
//# sourceMappingURL=index.js.map
