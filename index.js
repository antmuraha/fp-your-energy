var j=e=>{throw TypeError(e)};var K=(e,t,s)=>t.has(e)||j("Cannot "+s);var h=(e,t,s)=>(K(e,t,"read from private field"),s?s.call(e):t.get(e)),M=(e,t,s)=>t.has(e)?j("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),Y=(e,t,s,o)=>(K(e,t,"write to private field"),o?o.call(e,s):t.set(e,s),s);import{i as A}from"./assets/vendor-DVYrn7a6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const he=e=>{if(!e||typeof e!="object")return"";const t=Object.fromEntries(Object.entries(e).filter(([o,r])=>r!==void 0));return Object.keys(t).length===0?"":"?"+new URLSearchParams(t).toString()},ye=(e,t)=>(s,{method:o="GET",query:r,body:i})=>new Promise(async(n,c)=>{const d=he(r),l=await fetch(`${e}${s}${d}`,{method:o,body:JSON.stringify(i),headers:{"Content-Type":"application/json"}});if(l.status>=500){c({status:l.status,data:null,error:l.statusText||"Unknown error",isError:!0});return}let u=null;try{u=await l.json()}catch{c({status:500,data:null,error:"Parse error",isError:!0})}if(l.status>=400){c({status:l.status,data:u,error:l.statusText||"Unknown error",isError:!0});return}n({status:l.status,data:u,error:null,isError:!1})}),F=ye("https://your-energy.b.goit.study/api"),ve=async(e,t)=>await F(e,{...t,method:"GET",body:void 0}),pe=async(e,t)=>await F(e,{...t,method:"POST"}),be=async(e,t)=>await F(e,{...t,method:"PUT"}),Se=async(e,t)=>await F(e,{...t,method:"PATCH"}),Le=async(e,t)=>await F(e,{...t,method:"DELETE"}),x={get:ve,post:pe,put:be,patch:Se,del:Le};function te(e,t){document.dispatchEvent(new CustomEvent("stateChange",{detail:{branch:e,data:t}}))}const se="favorites";function xe(){const e=localStorage.getItem(se);if(e)try{return JSON.parse(e)}catch(t){return console.error("Error parsing favorites from local storage:",t),[]}return[]}function Ee(e){if(!Array.isArray(e)){console.error("Invalid data type for favorites. Expected an array.");return}const t=Array.from(new Set(e.map(s=>s._id))).map(s=>e.find(o=>o._id===s));try{localStorage.setItem(se,JSON.stringify(t))}catch(s){console.error("Error saving favorites to local storage:",s)}}const L={get:xe,set:Ee},qe=async(e,t=1,s=12)=>x.get("/filters",{query:{filter:e,page:t,limit:s}}),Pe=async()=>x.get("/quote"),we=async(e={})=>x.get("/exercises",{query:{bodypart:e.bodypart,muscles:e.muscles,equipment:e.equipment,keyword:e.keyword,page:e.page||1,limit:e.limit||10}}),Fe=async(e,t)=>x.patch(`/exercises/${e}/rating`,{body:{rate:t.rate,email:t.email,review:t.review}}),re=async e=>x.get(`/exercises/${e}`),Ce=async e=>x.post("/subscription",{body:{email:e}}),ke=async e=>{const t=await re(e);L.set([...L.get(),t.data]);const s=L.get();te("favorites",s)},Te=async e=>{const t=L.get().filter(s=>s._id!==e);L.set(t),te("favorites",t)},_e=async e=>L.get().some(t=>t._id===e),p={getFilters:qe,getQuoteOfDay:Pe,getExercises:we,addExerciseRating:Fe,getExerciseById:re,subscribe:Ce,addToFavorites:ke,removeFromFavorites:Te,isFavorite:_e},B={BODY_PARTS:"Body parts",Muscles:"Muscles",Equipment:"Equipment"},Me={[B.BODY_PARTS]:"bodypart",[B.Muscles]:"muscles",[B.Equipment]:"equipment"},Ae={MAP_GROUPS_TO_QUERY_PARAMS:Me};var y,b;class Be{constructor(t={}){M(this,y,{});M(this,b,{});Y(this,y,{...t}),this.startListening()}startListening(){document.addEventListener("stateChange",t=>{const{branch:s,data:o}=t.detail;console.log("Received new state:",s,o),this.setState(s,o)})}getState(t){return h(this,y)[t]}setState(t,s){h(this,y)[t]!==s&&(h(this,y)[t]=s,this.notify(t))}subscribe(t,s){h(this,b)[t]||(h(this,b)[t]=[]),h(this,b)[t].push(s),s(h(this,y)[t],h(this,y))}notify(t){if(h(this,b)[t])for(const s of h(this,b)[t])s(h(this,y)[t],h(this,y))}}y=new WeakMap,b=new WeakMap;class Ie{constructor(){this.subscribers=new Map,window.addEventListener("hashchange",this.handleHashChange.bind(this))}handleHashChange(){const t=window.location.hash;this.subscribers.forEach((s,o)=>{s(t)})}subscribe(t,s){return this.subscribers.has(t)||this.subscribers.set(t,s),()=>{this.subscribers.delete(t)}}isActive(t){return window.location.hash===t}}function $e(e){const t=document.getElementById("burgerBtn"),s=document.getElementById("burgerMenu"),o=document.getElementById("close-mob-menu"),r=document.querySelector(".social-links"),i=document.querySelector(".link-home-btn"),n=document.querySelector(".link-favorites-btn"),c=document.querySelector(".link-home-mobile"),d=document.querySelector(".link-favorites-mobile");function l(f,S){f.classList.add("nav-btn-active"),f.classList.remove("nav-btn-inactive"),S.classList.add("nav-btn-inactive"),S.classList.remove("nav-btn-active")}function u(){e.isActive("#favorites")?(l(n,i),l(d,c)):(l(i,n),l(c,d))}function g(f=!1){s.classList.remove("open"),setTimeout(u,50)}i.addEventListener("click",()=>g(!1)),n.addEventListener("click",()=>g(!0)),c.addEventListener("click",()=>g(!1)),d.addEventListener("click",()=>g(!0)),t.addEventListener("click",()=>{s.classList.add("open")}),o.addEventListener("click",()=>{s.classList.remove("open")}),window.addEventListener("click",f=>{!s.contains(f.target)&&!t.contains(f.target)&&s.classList.remove("open")});const v=()=>{window.innerWidth<=768?r.style.display="none":r.style.display=""};document.querySelectorAll(".link-icon").forEach(f=>{f.addEventListener("click",()=>{f.blur()})}),v(),u()}const I={timeout:3e3,close:!1,closeOnClick:!0,icon:null,position:"topRight",transitionIn:"fadeInDown",transitionOut:"fadeOutUp"};class m{static success(t){A.success({title:"OK",titleColor:"green",message:t,messageColor:"green",progressBarColor:"green",...I})}static error(t){A.error({title:"Error",titleColor:"red",message:t,messageColor:"red",progressBarColor:"red",...I})}static warning(t){A.warning({title:"Caution",message:t,titleColor:"red",messageColor:"red",progressBarColor:"red",...I})}}function oe(e,t=!1){const r=document.querySelector("#templates").content.querySelector(".favorites-workout-card").cloneNode(!0);return r.dataset.id=e._id,t?(r.querySelector(".delete").classList.remove("hidden"),r.querySelector(".favorites-workout-card-rating-container").classList.add("hidden")):(r.querySelector(".delete").classList.add("hidden"),r.querySelector(".rating-value").textContent=e.rating,r.querySelector(".favorites-workout-card-rating-container").classList.remove("hidden")),r.querySelector(".title").textContent=e.name,r.querySelector(".burned-calories").textContent=`${e.burnedCalories} / ${e.time} min`,r.querySelector(".group").textContent=e._group,r.querySelector(".group-target").textContent=e.bodyPart,r.querySelector(".filter").textContent=e.target,r}function ie(e,t){const s=document.querySelector(".exercises-workout-list");if(!t){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.innerHTML="",e.forEach(o=>{const r=oe(o);s.appendChild(r)}),(e==null?void 0:e.length)===0?document.querySelector(".exercises-empty-message").classList.remove("hidden"):document.querySelector(".exercises-empty-message").classList.add("hidden")}function Oe(e){const t=document.querySelector(".exercises-header-container");if(e){t.querySelector(".filter").textContent=e||"",t.classList.remove("hidden");return}t.classList.add("hidden")}function Re(e){const t=document.querySelector(".favorites-content-list"),s=t==null?void 0:t.querySelector(".favorites-list"),o=t==null?void 0:t.querySelector(".favorites-empty-message");if(s.innerHTML="",e.length===0){o.classList.remove("hidden"),s.classList.add("hidden");return}o.classList.add("hidden"),s.classList.remove("hidden"),e.forEach(r=>{const i=oe(r,!0);s.appendChild(i)})}function Ne(e,{group:t,filter:s,image:o}){const i=document.querySelector("#templates").content.querySelector(".exercises-card-filter");let n=i==null?void 0:i.getAttribute("style");if(n=n.replace("{=$image}",`${o}`),e)e.setAttribute("style",n),e.querySelector("h3").textContent=z(s),e.querySelector("h3").setAttribute("data-filter",s),e.querySelector("div").textContent=t,e.querySelector("div").setAttribute("data-group",t);else{const c=i.cloneNode(!0);return c.setAttribute("style",n),c.querySelector("h3").textContent=z(s),c.querySelector("h3").setAttribute("data-filter",s),c.querySelector("div").textContent=t,c.querySelector("div").setAttribute("data-group",t),c}}function z(e){return typeof e=="string"?`${e.charAt(0).toUpperCase()}${e.slice(1)}`:e}const J=12;function ne(e,t){var o;const s=document.querySelector(".exercises-filters-list");if(t){s==null||s.classList.add("hidden");return}if(s==null||s.classList.remove("hidden"),e.forEach((r,i)=>{const{filter:n,imgURL:c,name:d}=r;s.children[i]&&(s.children[i].classList.remove("hidden"),Ne(s.children[i],{filter:d,image:c,group:n}))}),e.length<J){const r=J-e.length;for(let i=0;i<r;i++)(o=s==null?void 0:s.children[i+e.length])==null||o.classList.add("hidden")}}function Q(e,t){const s=document.getElementById("exercises-list-pagination-buttons");if(!t||t<=1||t=="1"){s==null||s.classList.add("hidden");return}s==null||s.classList.remove("hidden"),s.querySelector(".arrow-buttons-left"),s.querySelector(".arrow-buttons-right");const o=s.querySelector(".page-buttons");o.innerHTML="";for(let r=1;r<=t;r++){const i=document.createElement("button");i.dataset.page=r,i.className="page-button",i.textContent=r,r==e&&i.classList.add("active"),o.appendChild(i)}}function Ge(e){const t=document.querySelector(".search-field"),s=t==null?void 0:t.querySelector(".search-input");e?(t==null||t.classList.remove("hidden"),s==null||s.setAttribute("value","")):t==null||t.classList.add("hidden")}const Ue=500;function De(e,t){const s=document.querySelector(".search-field"),o=s==null?void 0:s.querySelector(".search-input"),r=s==null?void 0:s.querySelector(".clear-button"),i=s==null?void 0:s.querySelector(".search-icon");o.value="",r.classList.add("hidden"),i.classList.remove("hidden");let n;o.addEventListener("input",d=>{const l=d.target.value.trim();clearTimeout(n),n=setTimeout(()=>{t(l)},Ue),r.classList.toggle("hidden",!l),i.classList.toggle("hidden",!!l)}),r.addEventListener("click",()=>{o.value="",r.classList.add("hidden"),i.classList.remove("hidden"),t(""),o.focus()}),new MutationObserver(()=>{const d=(o.getAttribute("value")||"").trim();o.value=d,t(d),r.classList.toggle("hidden",!d),i.classList.toggle("hidden",!!d)}).observe(o,{attributes:!0,attributeFilter:["value"]})}function _(e){if(!e)return null;for(;e&&!e.dataset.id;)e=e.parentElement;return e?e.dataset.id:null}const D=new Ie,ce=D.isActive("#favorites"),a=new Be({loading:!1,search:"",selectedGroup:"Muscles",selectedFilter:null,filtersPage:1,filtersPerPage:12,filtersTotalPages:null,filters:[],exercises:[],exercisesPage:1,exercisesPerPage:10,exercisesTotalPages:null,showFavorites:ce,favorites:L.get()||[]});ce&&document.body.classList.add("modal-open");D.subscribe("main",e=>{console.log("Main hash changed:",e);const t={"#favorites":()=>{a.setState("showFavorites",!0),document.body.classList.add("modal-open")},"":()=>{a.setState("showFavorites",!1),document.body.classList.remove("modal-open")}};try{t[e]()}catch{console.error("Not implemented action for hash:",e)}});$e(D);a.subscribe("showFavorites",(e,t)=>{console.log("Show favorites state changed:",e);const s=document.querySelector("#favorites"),o=document.querySelector("main");e?(o==null||o.classList.add("hidden"),s.classList.remove("hidden"),s.style.setProperty("--height",`${window.innerHeight}px`)):(o==null||o.classList.remove("hidden"),s.classList.add("hidden"))});const C=document.querySelector(".tabs-controls");C.addEventListener("click",e=>{var t;if(e.target.dataset.group){(t=C==null?void 0:C.querySelector(".active"))==null||t.classList.remove("active"),e.target.classList.add("active");const s=e.target.dataset.group;console.log("Selected category:",s),a.setState("selectedGroup",s),a.setState("selectedFilter",null)}});function G(e,t,s){return`${e}-${t}-${s}`}let P=!1;async function ae(e){if(P){console.log("Filters are already being updated, skipping this call");return}P=!0;const{selectedGroup:t}=e;console.log("Selected category changed:",t);const s=G(e.filtersPerPage,e.filtersPage,t),o=e.filters.find(l=>l._key===s);if(o){console.log("Filters already loaded for this group:",t,e.filters),a.setState("filters",[...e.filters]),a.setState("filtersTotalPages",o._total),P=!1;return}const r=await p.getFilters(t,e.filtersPage);if(console.log("Filters data:",t,r,e),r.isError){console.error("Error fetching filters:",r.error),P=!1;return}const{results:i,page:n,perPage:c,totalPages:d}=r.data;a.setState("filters",[...e.filters,...i.map(l=>({...l,_key:G(c,n,t),_total:d}))]),a.setState("filtersPerPage",c),a.setState("filtersTotalPages",d),P=!1}a.subscribe("selectedGroup",(e,t)=>ae(t));a.subscribe("filtersPage",(e,t)=>ae(t));a.subscribe("selectedFilter",Oe);De("",e=>a.setState("search",e));a.subscribe("selectedFilter",e=>Ge(!!e));a.subscribe("filters",(e,t)=>{const{filtersPerPage:s,filtersPage:o,selectedGroup:r}=t,i=e.filter(n=>n._key===G(s,o,r));console.log("Filters list:",i),ne(i)});a.subscribe("selectedFilter",(e,t)=>{e&&ne(null,e)});const $=document.querySelector(".exercises-filters-list");$==null||$.addEventListener("click",e=>{if(e.target.classList.contains("exercises-card-filter")){const t=e.target.querySelector("[data-filter]").dataset.filter;console.log("Selected filter:",t),a.setState("selectedFilter",t)}});function U(e,t,s,o,r=""){return`${e}-${t}-${s}-${o}-${r}`}let w=!1;async function H(e){if(w){console.log("Exercises are already being updated, skipping this call");return}w=!0;const{selectedFilter:t}=e;if(!t){console.log("No filter selected, skipping exercises fetch"),w=!1;return}const s=U(e.exercisesPerPage,e.exercisesPage,e.selectedGroup,t,e.search),o=e.exercises.find(n=>n._key===s);if(o){console.log("Exercises already loaded for this filter:",t,e.exercises),a.setState("exercises",[...e.exercises]),a.setState("exercisesTotalPages",o._total),w=!1;return}const i={[Ae.MAP_GROUPS_TO_QUERY_PARAMS[e.selectedGroup]]:t,page:e.exercisesPage,limit:e.exercisesPerPage,keyword:e.search};p.getExercises(i).then(n=>{if(n.isError){console.error("Error fetching exercises:",n.error);return}const{results:c,page:d,perPage:l,totalPages:u}=n.data;console.log("Exercises data:",n.data),a.setState("exercises",[...e.exercises,...c.map(g=>({...g,_group:e.selectedGroup,_key:U(l,d,e.selectedGroup,t,e.search),_total:u}))]),a.setState("exercisesPerPage",l),a.setState("exercisesTotalPages",u),w=!1})}a.subscribe("selectedFilter",(e,t)=>H(t));a.subscribe("exercisesPage",(e,t)=>H(t));a.subscribe("search",(e,t)=>H(t));a.subscribe("exercises",(e,t)=>{const{exercisesPerPage:s,exercisesPage:o,selectedGroup:r,selectedFilter:i,search:n}=t,c=e.filter(d=>d._key===U(s,o,r,i,n));console.log("Exercises list:",{exercises:e,list:c}),ie(c,i)});a.subscribe("selectedFilter",(e,t)=>{e||ie(!1,e)});a.subscribe("favorites",(e,t)=>{console.log("Favorites list:",e),Re(e)});var Z;(Z=document.querySelector(".favorites-content-list"))==null||Z.addEventListener("click",e=>{if(e.target.classList.contains("delete")){const t=_(e.target);p.removeFromFavorites(t).then(()=>{m.success("Exercise removed from favorites")}).catch(s=>{m.error("Failed to remove exercise from favorites")})}});function E(e){const{selectedFilter:t}=e;t?Q(e.exercisesPage,e.exercisesTotalPages):Q(e.filtersPage,e.filtersTotalPages)}a.subscribe("filtersTotalPages",(e,t)=>E(t));a.subscribe("filtersPage",(e,t)=>E(t));a.subscribe("exercisesTotalPages",(e,t)=>E(t));a.subscribe("exercisesPage",(e,t)=>E(t));a.subscribe("selectedGroup",(e,t)=>E(t));a.subscribe("selectedFilter",(e,t)=>E(t));var ee;(ee=document.querySelector(".page-buttons"))==null||ee.addEventListener("click",e=>{const t=e.target.dataset.page;t&&(a.getState("selectedFilter")?a.setState("exercisesPage",Number(t)):a.setState("filtersPage",Number(t)))});const k=document.getElementById("subscribeForm"),T=k.querySelector('input[name="email"]'),X=document.getElementById("subscribeBtn");T.addEventListener("input",He);k.addEventListener("submit",Ve);function le(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function He(){const e=T.value,t=le(e);T.style.borderColor=t?"green":"red"}async function Ve(e){e.preventDefault();const s=new FormData(k).get("email");if(!le(s))return console.error("Invalid email address"),m.error("Invalid email address");X.disabled=!0,p.subscribe(s).then(r=>{k.reset(),T.style.borderColor="",m.success(`${r.data.message}`)}).catch(r=>{var i;return m.error(((i=r==null?void 0:r.data)==null?void 0:i.message)||"Subscription failed")}).finally(()=>{X.disabled=!1})}function de(e){const t=document.getElementById("modal-rating"),s=t==null?void 0:t.querySelector(".modal-content");t.style.display="flex";const o=document.getElementById("subscribe-details-form"),r=document.getElementById("modal-close"),i=document.getElementById("rating-value"),n=document.getElementById("rating-stars");let c=0;n==null||n.addEventListener("click",u=>{const g=n.getBoundingClientRect(),f=(u.clientX-g.left)/g.width;c=Math.round(f*5),i.textContent=c.toFixed(1),d(c)}),n&&i&&(n.addEventListener("mousemove",u=>{const g=n.getBoundingClientRect(),f=(u.clientX-g.left)/g.width,S=Math.round(f*5*10)/10;i.textContent=S.toFixed(1),d(S)}),n.addEventListener("mouseleave",()=>{i.textContent=c.toFixed(1),d(c)}),n.addEventListener("click",u=>{const g=n.getBoundingClientRect(),f=(u.clientX-g.left)/g.width;c=Math.round(f*5*10)/10,i.textContent=c.toFixed(1),d(c)}));function d(u){n.querySelectorAll(".star-icon").forEach((v,f)=>{f<Math.round(u)?v.classList.add("active"):v.classList.remove("active")})}s.addEventListener("click",u=>{u.stopPropagation()});function l(){t.style.display="none",c=0,i.textContent="0.0",d(0)}r.addEventListener("click",l),t.addEventListener("click",l),o.addEventListener("submit",async u=>{u.preventDefault();const g="64f389465ae26083f39b17a2",v=o.elements.email,f=o.elements.comment,S=v.value.trim(),fe=f.value.trim(),ge=c;if(!v.checkValidity()){m.error("Please enter a valid email address.");return}try{const q=await fetch(`https://your-energy.b.goit.study/api/exercises/${g}/rating`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rate:ge,email:S,review:fe})});if(q.status===409){m.warning("You have already submitted a review for this exercise.");return}else if(q.ok)m.success("Your feedback has been submitted successfully!"),o.reset(),t.style.display="none",c=0,i.textContent="0.0",d(0);else{const me=await q.json();m.error(`Error ${q.status}: ${me.message||"Unknown error"}`);return}}catch{m.error("Something went wrong. Please try again later.")}})}async function je(e){await p.isFavorite(e)?p.removeFromFavorites(e).then(()=>{m.success("Exercise removed from favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),m.error("Failed to remove exercise from favorites")}):p.addToFavorites(e).then(()=>{m.success("Exercise added to favorites")}).catch(s=>{console.error("Error adding exercise to favorites:",s),m.error("Failed to add exercise to favorites")})}function W(e){return typeof e=="string"?`${e.charAt(0).toUpperCase()}${e.slice(1)}`:e}async function ue(e){var n,c,d;const t=(n=await p.getExerciseById(e))==null?void 0:n.data,s=await p.isFavorite(e);document.querySelector(".modal-title").textContent=W(t.name),s?(c=document.querySelector(".icon-favorite"))==null||c.classList.add("active"):(d=document.querySelector(".icon-favorite"))==null||d.classList.remove("active"),document.querySelector(".modal-rate-value").textContent=t.rating;const o=document.querySelectorAll(".exercise-info-text"),r=[t.target,t.bodyPart,t.equipment,t.popularity,t.burnedCalories];o.forEach((l,u)=>l.textContent=W(r[u])),document.querySelector(".modal-img").setAttribute("src",t.gifUrl),document.querySelector(".modal-description").textContent=t.description,document.querySelector(".btn-favorite").onclick=()=>{var l;je(e),(l=document.querySelector(".icon-favorite"))==null||l.classList.toggle("active")},document.querySelector(".btn-rating").onclick=()=>{V(),de()},document.querySelector(".backdrop").classList.add("is-open"),document.body.classList.add("modal-open");const i=document.querySelectorAll(".star-rating-icon");for(let l=0;l<Math.round(t.rating);++l)i[l].style.fill="#eea10c"}function V(){document.querySelector(".backdrop").classList.remove("is-open"),document.body.classList.remove("modal-open")}document.querySelector(".modal-close-btn").addEventListener("click",V);document.querySelector(".backdrop").addEventListener("click",e=>{e.target===e.currentTarget&&V()});const O=document.querySelector(".exercises-workout-list");O==null||O.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=_(e.target);ue(t)}});const R=document.querySelector(".favorites-list");R==null||R.addEventListener("click",e=>{if(e.target.classList.contains("start")){const t=_(e.target);ue(t)}});const N=document.querySelector(".exercises-workout-list");N==null||N.addEventListener("click",e=>{e.target.classList.contains("rating")&&(_(e.target),de())});
//# sourceMappingURL=index.js.map
